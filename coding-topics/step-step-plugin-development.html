---
title: '一步步：插件開發
parent: Coding Topics
description: In this topic you will learn via a hands-on introduction about plugin development and use.
---

<article class="bcls-article">
  <h1>一步步：插件開發</h1>
  <summary>{{ page.description }}</summary>
  <section id="developmentapproach" class="bcls-section">
    <h2>開發方式</h2>
    <p>您為插件開發的JavaScript和CSS最終將需要存儲在Internet上可訪問的位置，但是建議在開發過程中在本地創建和測試。為此，您將執行以下操作：</p>
    <ul>
      <li>創建一個文件以包含您的JavaScript插件代碼</li>
      <li>創建一個包含CSS插件代碼的文件（如果需要）</li>
      <li>創建一個HTML文件進行測試。使用<code translate="No">embed_in_page</code>播放器的實現</li>
      <li>添加一個<code translate="No">id</code>到<code translate="No">&lt;video-js&gt;</code>標籤</li>
      <li>鏈接到JavaScript和CSS頁面</li>
      <li>用一個<code translate="No">&lt;script&gt;</code>標籤來調用函數</li>
      <li>開發和調試代碼</li>
    </ul>
    <p>本文檔的其餘部分將指導您完成這些步驟，以構建和部署簡單的插件。</p>
  </section>
  <section id="buildthebasics" class="bcls-section">
    <h2>建立基礎</h2>
    <p>要開始構建插件的過程，您需要執行上述一些基本的高級步驟。</p>
    <ol class="bcls-tasklist">
      <li>創建一個名為的文件夾<code translate="No">plugin-dev</code>可以使用實際的HTTP服務器進行瀏覽。該服務器對於本文檔後面的iframe實施測試是必需的。</li>
      <li>在文件夾中，使用以下名稱創建三個文件：
        <ul>
          <li><strong translate="No">插件-dev.html</strong>（將 HTML 頁面的基本元素插入文件中）</li>
          <li><strong translate="No">插件-dev.js</strong></li>
          <li><strong translate="No">插件-dev.css</strong></li>
        </ul>
      </li>
      <li>使用工作室的<strong translate="No">球員</strong>模塊，創建一個新的播放器。</li>
      <li class="video-cloud-only">在裡面<strong translate="No">媒體</strong>模塊，選擇一個視頻並使用新創建的播放器發布它。</li>
      <li class="player-only">使用<strong translate="No">視頻內容</strong>部分，將視頻與播放器關聯，然後保存並發布播放器。</li>
      <li class="video-cloud-only">複製<strong translate="No">先進的</strong>代碼並粘貼到正文中<code translate="No">plugin-dev.html</code>頁。</li>
      <li class="player-only">來自<strong translate="No">嵌入代碼和 URL&gt;已發布的播放器</strong>菜單，複製<strong translate="No">高級嵌入代碼</strong>代碼並粘貼到正文中<code translate="No">plugin-dev.html</code>頁。</li>
      <li>添加一個<code translate="No">id</code>歸因於<code translate="No">&lt;video-js&gt;</code>值為的標籤<code translate="No">player</code>。</li>
      <li>檢查以確保您的HTML頁面與以下內容相似<span class="player-only">（Brightcove Player客戶將不會<code translate="No">data-video-id</code>財產）</span>：
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;!doctype html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;Quick Start Plugin Dev&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;video-js id="player"
    data-video-id="4607746980001"
    data-account="1507807800001"
    data-player="Bk6LLayNQ"
    data-embed="default"
    class="video-js" controls&gt;&lt;/video&gt;
  &lt;script src="https://players.brightcove.net/1507807800001/Bk6LLayNQ_default/index.min.js"&gt;&lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
      </li>
      <li>瀏覽頁面以確保您的視頻正在播放。</li>
    </ol>
  </section>
  <section id="javascript" class="bcls-section">
    <h2>創建JavaScript</h2>
    <p>接下來，您將創建並測試JavaScript代碼以構建視頻的疊加層。</p>
    <ol class="bcls-tasklist">
      <li>開啟檔案<code translate="No">plugin-dev.js</code>並粘貼以下JavaScript代碼：
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginDev', function() {
  var player = this,
  overlay = document.createElement('p');
  overlay.className = 'vjs-overlay';
  overlay.innerHTML = "Becoming a plugin developer";
  player.el().appendChild(overlay);
});</code></pre>
        <aside class="bcls-aside bcls-aside--information">注意：對於 5.x 及更早版本的播放器，您必須使用<code translate="No">videojs.plugin()</code>代替<code translate="No">videojs.registerPlugin()</code></aside>
      </li>
      <li>檢查您對插入的每一行的理解：
        <ul>
          <li>第1行和第7行是開始和結束新播放器插件的標準語法。在這種情況下，插件名稱為<code translate="No">pluginDev</code>。</li>
          <li>第2行是獲取播放器句柄的一種標準方法。這是調用播放器的方法所必需的，您稍後將進行此操作。</li>
          <li>第3行在文檔中創建一個段落元素，並將其分配給<code translate="No">overlay</code>多變的。</li>
          <li>第4行為覆蓋層分配了一個類，稍後將與CSS結合使用。</li>
          <li>第5行將文本添加到段落元素。</li>
          <li>第6行使用<code translate="No">el()</code>播放器的DOM方法，以檢索播放器的DOM元素，然後將新的段落元素附加到該DOM。</li>
        </ul>
        <aside class="bcls-aside bcls-aside--information">注意：插件的 JavaScript 代碼（上面的第 7 行）末尾的尾隨分號是必需的。
      </li>
      <li>在HTML文件中，將以下代碼添加到現有文件的正下方<code translate="No">&lt;script&gt;</code>標籤。此代碼包括JavaScript文件，然後調用該JavaScript中定義的方法。
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type="text/javascript" src="plugin-dev.js"&gt;&lt;/script&gt;
&lt;script&gt;videojs.getPlayer('myPlayerID').pluginDev();&lt;/script&gt;</code></pre>
      </li>
      <li>再次瀏覽HTML頁面，您將看不到任何可見的變化。問題在於覆蓋層在那裡，但不可見。您稍後將對此進行更改。</li>
      <li>要驗證是否存在疊加層，請使用瀏覽器的開發工具。在裡面 <em>元素</em> 部分，檢查播放器的<code translate="No">&lt;div&gt;</code>元素，您將看到新插入的段落元素，如下所示：
        <figure class="bcls-figure"><img class="bcls-image" alt="quick-start-overlay-in-elements" src="/assets/images/coding-topics/sbs-plugin-quick-start-overlay-in-elements.png" /></figure>
      </li>
    </ol>
  </section>
  <section id="styletheplugin" class="bcls-section">
    <h2>設置插件樣式</h2>
    <p>您知道疊加層現在是播放器的一部分，但不可見。接下來，您將對疊加層進行樣式設置，使其可見。在文檔的此部分中，您將使用非常簡單的CSS來確保疊加層可見。</p>
    <ol class="bcls-tasklist">
      <li>開啟檔案<code translate="No">plugin-dev.css</code>並粘貼以下樣式：
        <pre class="line-numbers">
<code class="language-javascript" translate="No">.vjs-overlay {
    background-color: #333333;
    color: white;
    position: absolute;
    margin-top: 100px;
    margin-left: 20px;
}</code></pre>
      </li>
      <li>在HTML文件中，將以下代碼添加到現有文件的正下方<code translate="No">&lt;link&gt;</code>標籤。此代碼鏈接到您新創建的CSS文件。
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;link href="plugin-dev.css" rel="stylesheet"&gt;</code></pre>
      </li>
      <li>瀏覽HTML頁面，您將看到疊加層現在可見。
        <figure class="bcls-figure"><img class="bcls-image" alt="quick-start-overlay-showing" src="/assets/images/coding-topics/sbs-plugin-quick-start-overlay-showing.png" /></figure>
      </li>
    </ol>
  </section>
  <section id="passdatatoplugin" class="bcls-section">
    <h2>將數據傳遞給插件</h2>
    <p>通常情況下，您希望在初始化時更改插件的行為。這可以通過以下方式將數據傳遞到插件中：<code translate="No">options</code>財產。在此示例中，您將傳入要在疊加層中顯示的文本。</p>
    <ol class="bcls-tasklist">
      <li>打開 HTML 頁面並更改<code translate="No">&lt;script&gt;</code>標記所以一個名為的變量<code translate="No">options</code>創建並分配一個具有鍵值對的對象 <em>"overlayText":"This data is supplied at initialization"</em>.另外，通過<code translate="No">options</code>調用時將變量作為參數<code translate="No">pluginDev()</code>方法。所做的更改應如下所示：
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type="text/javascript" src="plugin-dev-copy.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  <span class="bcls-highlight">var options = {"overlayText": "This data supplied at initialization"};</span>
&lt;/script&gt;
<span class="bcls-highlight">&lt;script&gt;videojs.getPlayer('myPlayerID').pluginDev(options);&lt;/script&gt;</span></code></pre>
      </li>
      <li>現在，您需要更改插件的JavaScript以使用傳遞給該函數的數據。第110行顯示了接受數據作為參數的函數，第114行使用了對象的數據。
        <pre class="line-numbers">
<code class="language-javascript" translate="No"><span class="bcls-highlight">videojs.registerPlugin('pluginDev', function(options) {</span>
  var player = this,
  overlay = document.createElement('p');
  overlay.className = 'vjs-overlay';
  <span class="bcls-highlight">overlay.innerHTML = options.overlayText;</span>
  player.el().appendChild(overlay);
});</code></pre>
      </li>
      <li>瀏覽HTML頁面，您將看到正在使用的新文本。
        <figure class="bcls-figure"><img class="bcls-image" alt="quick-start-options-showing" src="/assets/images/coding-topics/sbs-plugin-quick-start-options-showing.png" /></figure>
      </li>
    </ol>
    <aside class="bcls-aside bcls-aside--warning">注意：本文檔此部分中顯示的過程（包括通過JavaScript調用插件）是出於開發目的，對於初始配置和測試很有用，但不是最佳實踐。最佳做法是將插件作為播放器配置 Studio 的一部分（如下一節所示），即使您使用的是 embed_in_page 實現。
  </section>
  <section id="deploytheplugin" class="bcls-section">
    <h2>部署插件</h2>
    <p>插件，CSS和播放器正常運行後，您需要部署資產以正確使用。以下是部署所需步驟的概述：</p>
    <ul>
      <li>將JavaScript和CSS文件複製/移動到您的遠程位置</li>
      <li>使用Studio將插件配置添加到播放器。</li>
      <li>創建一個HTML文件進行測試，並將iframe實施用於播放器</li>
      <li>測試異常</li>
    </ul>
    <p>現在，將指導您完成這些步驟。</p>
    <ol class="bcls-tasklist">
      <li>將插件的JavaScript和CSS文件移動到您選擇的Internet可訪問位置。<aside class="bcls-aside bcls-aside--information">如果您選擇，您可以使用示例中下面所示位置的文件。你也可以使用<a href="https://apis.support.brightcove.com/delivery-system/">交付系統API</a>將文件存儲在您自己的倉庫中。
      </li>
      <li>在工作所在的文件夾中，創建另一個名為<code translate="No">plugin-dev-iframe.html</code>。</li>
      <li>使用工作室的<strong translate="No">球員</strong>模塊來編輯您之前創建的播放器。</li>
      <li>點擊<strong>插件</strong>在左側導航菜單中。</li>
      <li>下一步點擊<strong>添加插件&gt;自定義插件</strong> .</li>
      <li>為了<strong>插件名稱</strong>進入<code translate="No">pluginDev</code>。</li>
      <li>為了<strong>的JavaScript</strong> URL，輸入（或您的URL）：
        <pre>
 <code class="language-json" translate="No">https://solutions.brightcove.com/bcls/brightcove-player/plugins/plugin-dev.js</code></pre>
      </li>
      <li>為了<strong>的CSS</strong> URL，輸入（或您的URL）：
        <pre>
 <code class="language-json" translate="No">https://solutions.brightcove.com/bcls/brightcove-player/plugins/plugin-dev.css</code></pre>
      </li>
      <li>在<strong>選項（JSON）</strong>文本框。
        <pre class="line-numbers">
 <code class="language-json" translate="No">{"overlayText": "This data is supplied at initialization"}</code></pre>
      </li>
      <li>您的配置對話框應類似於以下內容：
        <figure class="bcls-figure"><img class="bcls-image" alt="Plugins dialog" src="/assets/images/coding-topics/sbs-plugin-plugins-dialog.png" /></figure>
      </li>
      <li>點擊<strong>保存</strong>。</li>
      <li>若要發佈播放程式，請按一下「<strong>發佈與內嵌」&gt;「發佈變更」</strong>。</li>
      <li>若要關閉開啟對話方塊，請按一下「<strong>關閉」</strong>。</li>
      <li class="video-cloud-only">在裡面<strong translate="No">媒體</strong>模塊，選擇一個視頻並使用新更新和發布的播放器發布它。</li>
      <li class="video-cloud-only">複製<strong translate="No">標準</strong>代碼並粘貼到正文中<code translate="No">plugin-dev-iframe.html</code>頁。您的頁面應類似於以下內容：</li>
      <li class="player-only">來自<strong translate="No">嵌入代碼和 URL&gt;已發布的播放器</strong>菜單，複製<strong translate="No">標準嵌入代碼</strong>代碼並粘貼到正文中<code translate="No">plugin-dev-iframe.html</code>頁。您的頁面應類似於以下內容：
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;!doctype html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;Quick Start Plugin Dev - iframe&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;iframe src='https://players.brightcove.net/1507807800001/Bk6LLayNQ_default/index.html' allowfullscreen webkitallowfullscreen mozallowfullscreen&gt;&lt;/iframe&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
      </li>
      <li>瀏覽HTML頁面，您應該會看到該插件與iframe一起正常運行。</li>
    </ol>
  </section>
  <section id="3rdparty" class="bcls-section">
    <h2>第三方圖書館</h2>
    <p>如果您的插件依賴於第三方庫（例如jQuery），則需要通過以下兩種方式之一將其包括在內：</p>
    <ul>
      <li>將該庫作為另一個 JavaScript 文件添加到<strong translate="No">插件</strong>部分<strong translate="No">球員</strong>模塊輸入<span class="video-cloud-only">視頻雲</span>工作室。</li>
      <li>添加多個條目<strong translate="No">腳本</strong> curl 語句中的播放器配置部分。</li>
    </ul>
    <p>在上述兩種情況下，請確保在插件的JavaScript條目之前放置插件所依賴的庫。輸入順序確實很重要。</p>
  </section>
</article>