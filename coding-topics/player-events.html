---
title:玩家事件
parent: Coding Topics
description: In this topic, you will learn about the various types of events associated with Brightcove Player.
---

<article class="bcls-article">
  <h1>玩家事件</h1>
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Overview">概述</h2>
    <p>Brightcove Player具有許多事件供您控制視頻播放。本主題概述了不同類型的事件。</p>
    <p>可以在以下位置找到Brightcove Player事件的完整列表：<a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#toc120__anchor">播放器方法/事件API</a>參考文件。本文檔反映了構成播放器的實際代碼中的事件。</p>
  </section>
  <section class="bcls-section">
    <h2 id="mediaevents">媒體活動</h2>
    <p>這<a href="https://html.spec.whatwg.org/multipage/">HTML生活標準</a>該文檔是獲取有關HTML開發和Web應用程序所需API的信息的絕佳資源。這是一個“活著的"文檔，由Web超文本應用程序技術工作組（WHATWG）保持最新狀態，該工作組是一個不斷發展的社區，對網絡的發展感興趣。</p>
    <p>Brightcove Player在HTML框架之上運行，這將觸發以下操作<a href="https://html.spec.whatwg.org/multipage/embedded-content.html#mediaevents">媒體活動</a>。</p>
    <p>以下是與本文檔中的事件相關的一些術語：</p>
    <h3>受阻</h3>
    <p>如果回放已完成，則認為MediaController被阻止<a href="//dev.w3.org/html5/spec-preview/media-elements.html#paused-media-controller">已暫停</a>。如果媒體元素的控制器是<a href="//dev.w3.org/html5/spec-preview/media-elements.html#blocked-media-controller">阻止的媒體控制器</a>。</p>
    <h3>媒體控制器</h3>
    <p>一種<a href="//dev.w3.org/html5/spec-preview/media-elements.html#mediacontroller">媒體控制器</a>是協調多個媒體元素播放的對象。</p>
    <h3>媒體元素</h3>
    <p>一種<a href="//dev.w3.org/html5/spec-preview/media-elements.html#media-element">媒體元素</a>向用戶顯示音頻數據或視頻和音頻數據。</p>
    <h3>奴隸</h3>
    <p>默認情況下，每個媒體元素都沒有<code translate="No">MediaController</code>。當媒體元素與<code translate="No">MediaController</code>，據說是<a href="//dev.w3.org/html5/spec-preview/media-elements.html#slaved-media-elements">奴隸</a>到控制器。控制器修改從屬它的每個媒體元素的播放速率和音量。如果一個從屬元件意外停止，則控制器將停止其他從屬元件。</p>
  </section>
  <section class="bcls-section">
    <h2 id="bufferingandqosevents">緩沖和QoS事件</h2>
    <p>以下是與緩沖和服務質量（QoS）相關的事件的子集：</p>
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th style="width: 40%;" scope="col"><strong>活動名稱</strong></th>
          <th style="width: 60%;" scope="col"><strong>描述</strong></th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No"><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-progress">progress</a></code></td>
          <td>緩衝（加載）視頻數據</td>
        </tr>
        <tr>
          <td><code translate="No"><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-waiting">waiting</a></code></td>
          <td>暫時等待請求的視頻數據</td>
        </tr>
        <tr>
          <td><code translate="No"><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-stalled">stalled</a></code></td>
          <td>緩衝停頓</td>
        </tr>
        <tr>
          <td><code translate="No"><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-error">error</a></code></td>
          <td>加載視頻時發生錯誤</td>
        </tr>
        <tr>
          <td><code translate="No"><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-playing">playing</a></code></td>
          <td>暫停或下載延遲後恢復播放</td>
        </tr>
        <tr>
          <td><code translate="No"><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-media-ratechange">ratechange</a></code></td>
          <td>播放速率已更改（可以是手動或自動）</td>
        </tr>
      </tbody>
    </table>
    <aside class="bcls-aside bcls-aside--warning">在 Edge Windows 10 中<code translate="No">waiting</code>當有緩衝時，事件永遠不會被調度。</aside>
  </section>
  <section class="bcls-section">
    <h2 id="startupevents">啟動事件</h2>
    <p>播放器初始化並準備播放視頻時，會發生許多事件。它們按照將被分派的順序在此處列出：</p>
    <ul>
      <li>
        <p><code translate="No">loadstart</code>：在播放器初始化時以及在為播放器提供新播放源的情況下重新初始化時調度</p>
        <aside class="bcls-aside bcls-aside--tip">由於<code translate="No">loadstart</code>事件可能在播放器準備好之前發生，最好在調用播放器之前為此事件設置事件偵聽器<code translate="No">ready()</code>功能。請參閱下面的 CodePen。
      </li>
      <li><code translate="No">loadedmetadata</code>：在播放器具有初始持續時間和尺寸信息時（即在下載了第一段時）調度。對於直播視頻，<code translate="No">loadedmetadata</code>在用戶點擊播放之前，不會調度該事件。這是因為在用戶單擊播放之前，實時視頻不會開始下載片段。</li>
      <li><code translate="No">loadeddata</code>：播放器在當前播放位置下載數據時調度</li>
    </ul>
    <p>以下CodePen顯示了正在偵聽和調度的啟動事件。請注意，如果將鼠標懸停在CodePen上，則可以單擊<strong>重新運行</strong>位於右下角的按鈕可再次查看事件。如果您想嘗試使用該代碼，請點擊<strong>在CODEPEN上編輯</strong>標題中的鏈接以移至編輯環境。您可以點擊<strong>JS</strong>按鈕以查看添加事件偵聽器的JavaScript。</p>
    <p data-height="400" data-theme-id="14832" data-slug-hash="jPrdQm" data-default-tab="result" data-user="bcls" class="codepen">看筆<a href="http://codepen.io/team/bcls/pen/jPrdQm/">啟動活動演示</a>通過Brightcove學習服務（<a href="https://codepen.io/team/rcrooks1969"> @bcls</a>） 上<a href="http://codepen.io">密碼筆</a>。</p>
    <script async src="//assets.codepen.io/assets/embed/ei.js"></script>
    <aside class="bcls-aside bcls-aside--information">注意：初次加載此頁面時，您可能看不到<code translate="No">loadstart</code>事件。這是因為可以在CodePen在頁面上完全呈現之前分派該事件。點擊<strong>重新運行</strong>按鈕，您將看到所有三個事件都已調度。
    <h3>ready（）方法</h3>
    <p>這<code translate="No">ready()</code>方法具有雙重個性，因為它看起來像是一個事件，但是您卻像方法一樣使用它。此方法/事件表示播放器已準備好接收命令。</p>
    <p>這<code translate="No">ready()</code>方法與事件偵聽器的不同之處在於，如果<code translate="No">ready</code>事件已經發生，將觸發<code translate="No">ready()</code>立即使用方法。您經常會看到以下方法，這些方法為使用Brightcove Player開發提供了起點：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function(){
  var myPlayer = this;
});</code></pre>
    <aside class="bcls-aside bcls-aside--tip">注意：重要的是要意識到，如果播放器必須切換播放技術，例如從 HTML 到 Flash，才能播放視頻<code translate="No">ready</code>一旦新的播放技術啟動並運行，方法/事件事件處理程序將重新運行。
    <h3>ready（）與on（'loadedmetadata'，...）</h3>
    <p>注意使用<code translate="No">ready()</code>如果您希望與播放器進行交互，則可以正常運行，例如以編程方式添加插件。例如，如果您想立即與視頻互動，請使用<code translate="No">play()</code>，上述代碼段將無法始終正常運行。更好的方法是聽取<code translate="No">loadedmetadata</code>與視頻互動，例如：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').on('loadedmetadata',function(){
  var myPlayer = this;
  myPlayer.play();
});</code></pre>
    <p>總之，要與玩家互動，您可以使用以下方法：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready()</code></pre>
    <p>如果您希望立即與播放器中的視頻進行交互，請使用以下命令：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').on('loadedmetadata',function(){})</code></pre>
    <aside class="bcls-aside bcls-aside--information">注意：你必須等待的原因<code translate="No">loadedmetadata</code>要調度的事件是它確保目錄在嘗試播放之前有時間檢索視頻。
  </section>
  <section id="fullscreenEvents">
    <h2 class="bcls-section">全屏活動</h2>
    <p>一種<code translate="No">fullscreenchange</code>切換到全屏模式或從全屏模式切換到播放器時，會發出事件。無論播放器將進入全屏模式還是返回正常模式，都會廣播相同的事件。如果對於您而言重要的是知道發生了什麼，請使用<code translate="No">player.isFullscreen()</code>確定播放器當前是否處於全屏模式的方法。</p>
    <p>下面的Codepen說明瞭如何執行此操作。</p>
    <p data-height="766" data-theme-id="14832" data-slug-hash="JGEdEd" data-default-tab="result" data-user="bcls" class="codepen">看筆<a href="http://codepen.io/team/bcls/pen/JGEdEd/">Brightcove Player全屏活動</a>通過Brightcove學習服務（<a href="http://codepen.io/bcls"> @bcls</a>） 上<a href="http://codepen.io">密碼筆</a>。</p>
    <script async src="//assets.codepen.io/assets/embed/ei.js"></script></section>
  <section class="bcls-section">
    <h2 id="adevents">廣告活動</h2>
    <p>要將廣告庫和功能包含到播放器中，您可以使用<a href="/plugins/advertising-ima3-plugin.html">IMA3插件</a>或者<a href="/plugins/advertising-freewheel-plugin.html">FreeWheel插件</a>。這是建立在<a href="https://github.com/videojs/videojs-contrib-ads/blob/master/README.md">videojs廣告框架</a>（videojs-contrib-ads）。這兩個廣告插件都可以分發下表中顯示的廣告事件。每一個還具有特定於實現的特定事件。</p>
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th style="width:35%">事件 </th>
          <th style="width:65%">傳送時間：</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td>廣告請求</td>
          <td>根據要求提供廣告數據。</td>
        </tr>
        <tr>
          <td>廣告加載</td>
          <td>廣告請求後有可用的廣告數據時。</td>
        </tr>
        <tr>
          <td>廣告開始</td>
          <td>廣告已開始播放。</td>
        </tr>
        <tr>
          <td>ad-ad-end</td>
          <td>廣告已播放完畢。</td>
        </tr>
        <tr>
          <td>廣告暫停</td>
          <td>廣告已暫停。</td>
        </tr>
        <tr>
          <td>廣告播放</td>
          <td>廣告從暫停中恢復。</td>
        </tr>
        <tr>
          <td>廣告四分位數</td>
          <td>該廣告已播放了其總時長的25％。</td>
        </tr>
        <tr>
          <td>廣告中點</td>
          <td>該廣告已播放了其總時長的50％。</td>
        </tr>
        <tr>
          <td>廣告四分之三</td>
          <td>該廣告已播放了其總時長的75％。</td>
        </tr>
        <tr>
          <td>點擊廣告</td>
          <td>觀眾點擊了正在播放的廣告。</td>
        </tr>
        <tr>
          <td>廣告數量變化</td>
          <td>播放廣告的音量已更改。</td>
        </tr>
        <tr>
          <td>ads-pod開始</td>
          <td>線性廣告連播中的第一個廣告（按順序排列的一組廣告）已經開始。</td>
        </tr>
        <tr>
          <td>廣告廣告連播</td>
          <td>線性廣告連播中的最後一個廣告（按順序排列的一組廣告）已完成。</td>
        </tr>
        <tr>
          <td>廣告全部完成</td>
          <td>所有線性廣告均已播放完畢。</td>
        </tr>
      </tbody>
    </table>
  </section>
  <section id="bc-catalog-error" class="bcls-section">
    <h2>bc目錄錯誤事件</h2>
    <p>正常情況下可能會處理錯誤<code translate="No">ready()</code>腳本塊中的“節"可能會導致問題。例如，可能會發生<code translate="No">bc-catalog-error</code>事件可以在播放器準備就緒之前分派，如果您在<code translate="No">ready()</code>部分，您將無法處理該錯誤。使用地理過濾，未發布視頻，視頻超出計劃範圍或使用其他帳戶時，可能會發生此問題。有關完整的討論和處理示例<code translate="No">bc-catalog-error</code>活動，請參閱<a href="/references/player-catalog.html">玩家目錄</a>文檔。</p>
  </section>
  <section id="progresstimeupdate" class="bcls-section">
    <h2>進度和時間更新</h2>
    <p>關於兩者之間的差異可能會造成混淆<code translate="No">progress</code>和<code translate="No">timeupdate</code>事件。Brightcove Player建立在HTML5視頻的基礎上，按照該標準，<code translate="No">progress</code>瀏覽器下載數據時調度事件。這<code translate="No">timeupdate</code>當前播放位置更改時調度事件。</p>
    <p>這可能會使Brightcove Smart Player的用戶感到困惑，因為在該API中，<code translate="No">progress</code>事件做什麼<code translate="No">timeupdate</code>在Brightcove Player API中執行。</p>
  </section>
  <section id="section-name" class="bcls-section">
    <h2>小心刪除timeupdate偵聽器</h2>
    <p>在某些情況下，您可能想刪除添加到事件監聽器中的事件監聽器。<code translate="No">timeupdate</code>事件。用例顯示在<a href="/code-samples/brightcove-player-sample-register-play-after-preview.html">Brightcove Player示例：註冊預覽後播放</a>文檔。在這種情況下，您希望播放器在某個時間範圍內暫停，並且您正在使用<code translate="No">timeupdate</code>用於時間檢查，然後使用匿名事件處理程序函數定義。您只想暫停一次，因此您需要刪除事件監聽器。您不想簡單地做：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">myPlayer.off('timeupdate');</code></pre>
    <p>當然，這會將所有事件偵聽器刪除<code translate="No">timeupdate</code>，以及這樣做的其他問題將阻止時間淨化器的發展。需要做的是使用正常的函數定義語法（函數聲明）創建一個函數，然後僅刪除一個事件偵聽器。縮寫代碼如下所示：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No"> // Add the event handler
myPlayer.on('timeupdate', timeupdateHandler);

// Handle the event then remove JUST this event listener on timeupdate
function timeupdateHandler(evt) {
  ...
  myPlayer.off('timeupdate', timeupdateHandler);
}</code></pre>
  </section>
  <section class="bcls-section">
    <h2 id="analytics_events">分析事件</h2>
    <p>每次將信標發送到Google Analytics（分析）數據收集器時，都會觸發一個事件。您可以收聽任何信標或特定信標。</p>
    <h3>聽所有信標</h3>
    <p>您可以跟踪通過偵聽發送的所有分析信標<code translate="No">analytics_request</code>事件：</p>
<pre class="line-numbers"><code class="language-javascript" translate="No">player.on('analytics_request', function(e) {
  videojs.log('sent a(n) ' + e.params.event + ' beacon!', e.params);
});</code></pre>
    <h3>收聽特定的信標</h3>
    <p>您可以跟踪通過偵聽發送的特定分析信標<code translate="No">analytics_request_<span class="bcls-input">{beacon_name}</span></code>事件。</p>
    <p><code translate="No">{beacon_name}</code> is the name of any of the player events that are sent to the data collector.有關這些事件的完整列表，請參見<a href="https://apis.support.brightcove.com/data-collection/references/reference.html#tag/Events">數據收集API參考</a>。</p>
    <h4>例子</h4>
<pre class="line-numbers"><code class="language-javascript" translate="No">player.on('analytics_request_video_impression', function(e) {
  videojs.log('sent an impression beacon!', e.params);
});</code></pre>
  </section>
  <section class="bcls-section">
    <h2 id="No_support_for_method_chaining">不支持方法鏈接</h2>
    <p>從Brightcove Player版本6開始，不再支持與事件的方法鏈接。這意味著您不能執行以下操作：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">player.on(event, function () {})
.on(event, function () {})
.on(event, function () {})
.on(event, function () {});</code></pre>
  </section>
</article>