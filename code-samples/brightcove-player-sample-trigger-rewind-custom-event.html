---
title: '布萊特灣球員樣本：使用自定義事件觸發倒帶
description: '在本主題中，您將學習如何通過調度和偵聽自定義事件來實現倒帶按鈕。'
parent: Code Samples
---

<article class="bcls-article">
  <h1>布萊特灣球員樣本：使用自定義事件觸發倒帶</h1>
  <summary></summary>
  <section class="bcls-section">
    <h2 id="Overview">概述</h2>
    <aside class="bcls-aside bcls-aside--information">提供此示例和相關代碼作為生產開發的指南。該代碼未經認證可用於生產用途，也未經官方支持。</aside>
    <p>即使Brightcove Player提供了許多現成的事件，您仍可能希望使用自己的自定義事件來解耦並消除DOM對象與事件偵聽器之間的依賴關係。此事件驅動模型是您可能要考慮的體系結構選擇。</p>
    <p>此示例向控制欄添加一個後退按鈕。當用戶單擊“後退"按鈕時，將觸發自定義事件以及後退時間。自定義事件偵聽器找到當前視頻位置並倒帶視頻。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Player_example">播放器示例</h2>
    <!-- UPDATE description -->
    
    <p style="float:left">開始播放視頻。然後單擊後退按鈕：</p>
    <div><img style="width:40px;height:40px;margin-top:-10px;" alt="rewind video button" src="/assets/images/code-samples/brightcove-player-sample-trigger-rewind-custom-event/back-button.png" /></div>
    <p style="clear:both;">您應該看到視頻回放可以倒退5秒鐘。</p>
    <!-- UPDATE codepen here -->
    
    <p data-height="475" data-theme-id="34967" data-slug-hash="mBWvKb" data-default-tab="result" data-user="bcls1969" data-embed-version="2" data-pen-title="18150-trigger-rewind-custom-event" class="codepen">看筆<a href="https://codepen.io/team/bcls1969/pen/mBWvKb/">18150觸發倒帶自定義事件</a>通過Brightcove學習服務（<a href="https://codepen.io/team/rcrooks1969"> @ bcls1969</a>） 上<a href="https://codepen.io">密碼筆</a>。</p>
    <script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->
    
    <h3>源代碼</h3>
          <p>觀看<a href="https://github.com/BrightcoveLearning/18150-trigger-rewind-custom-event">GitHub上的完整解決方案</a>。</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">使用代碼筆</h2></summary>
      <p>以下是一些有效使用上述 CodePen 的提示：</p>
      <ul>
        <li>通過單擊切換播放器的實際顯示<strong translate="No">結果</strong>按鈕。</li>
        <li>點擊<strong translate="No">HTML/CSS/JS</strong>按鈕以顯示其中一種代碼類型。</li>
        <li>在本文檔的後面部分，應用程序中使用的邏輯、流程和样式將在<a href="#Player/HTML_configuration">播放器/HTML 配置</a> , <a href="#Application_flow">申請流程</a>和<a href="#Application_styling">應用樣式</a>部分。遵循這些部分中的信息的最佳方法是：
          <ol>
            <li>點擊<strong translate="No">在 CODEPEN 上編輯</strong> CodePen 中的按鈕，並在一個瀏覽器/瀏覽器選項卡中提供代碼。</li>
            <li>在CodePen中，調整要顯示的代碼。您可以在CodePen中更改不同代碼段的寬度。</li>
            <li>觀看<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Application_flow">申請流程</a>和/或<a href="#Application_styling">應用程式樣式</a>其他瀏覽器/瀏覽器標籤中的部分。現在，您將能夠按照代碼說明進行操作，同時查看代碼。</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Development_sequence">開發順序</h2></summary> 
      <p>這是推薦的開發順序：</p>
      <ol>
        <li>使用頁內嵌入播放器實現來測試播放器，插件和CSS的功能（如果需要CSS）</li>
        <li>將插件的JavaScript和CSS放入單獨的文件中以進行本地測試</li>
        <li>解決任何錯誤後，將插件代碼和CSS部署到服務器上</li>
        <li>使用Studio將插件和CSS添加到播放器</li>
        <li>如果您確定iframe實現更合適，請替換頁內嵌入播放器實現（在下一部分中詳細介紹）</li>
      </ol>
      <p>有關這些步驟的詳細信息，請查看<a href="/coding-topics/step-step-plugin-development.html">一步步：插件開發</a>指導。</p>
      <h3>iframe或頁內嵌入</h3>
      <p>在開發Brightcove Player的增強功能時，您需要確定代碼是否最適合iframe或頁內嵌入實施。最佳實踐建議是構建一個可與iframe實現配合使用的插件。使用iframe播放器的優點是：</p>
      <ul>
        <li>與現有的JavaScript和/或CSS無衝突</li>
        <li>自動響應</li>
        <li>iframe可簡化在社交媒體應用中的使用（或需要將視頻“傳播"到其他應用中的任何時候）</li>
      </ul>
      <p>儘管集成頁內嵌入播放器可能會更加複雜，但是有時您會圍繞該實現計劃代碼。概括地說，當包含頁面需要與播放器進行通信時，這種方法是最好的。具體來說，以下是一些示例：</p>
      <ul>
        <li>包含頁面中的代碼需要偵聽播放器事件並對其進行操作</li>
        <li>播放器使用包含頁面中的樣式</li>
        <li>iframe將導致應用邏輯失敗，例如從包含頁面的重定向</li>
      </ul>
      <p>即使最終實現未使用iframe代碼，您仍可以將頁內嵌入代碼與JavaScript插件和CSS單獨文件一起使用。這封裝了你的邏輯，以便您可以輕鬆地在多個玩家中使用它。</p>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="API/Plugin_resources_used">使用的API /插件資源</h2>
    <!-- UPDATE table, remove unneeded columns -->
    
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>API方法</th>
          <th>API事件</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Spacer.html#addChild">spacer.appendChild（）</a></td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/module-events.html#.trigger">觸發</a> </td>
        </tr>
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#currentTime">當前時間（）</a></td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/module-events.html#.on">在</a></td>
        </tr>
      </tbody>
    </table>
  </section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">播放器/ HTML配置</h2>
    <p>本節詳細介紹了播放器創建過程中所需的任何特殊配置。此外，還介紹了除頁面內嵌入播放器實現代碼外，還必須添加到頁面的其他HTML元素。</p>
    <h3>播放程式組態</h3>
    <p>您為此示例創建的Brightcove Player不需要任何特殊配置。</p>
    <h3>其他HTML</h3>
    <p>記得添加<code translate="No">id</code>歸因於<code translate="No">video-js</code>標籤在播放器中嵌入代碼。</p>
    <pre>
<code class="language-html" translate="No">&lt;video-js <span class="bcls-highlight">id="myPlayerID"</span>
...</code></pre>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">申請流程</h2>
    <p>此應用程序背後的基本邏輯是：</p>
    <ul>
      <li>在DOM中為快退按鈕創建一個新元素。</li>
      <li>將快退按鈕添加到播放器控制欄。</li>
      <li>當用戶單擊快退按鈕時進行偵聽。單擊後，使用數據觸發您的自定義事件。</li>
      <li>偵聽帶有數據的自定義事件，並根據定義的數據倒帶視頻播放。</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>向DOM添加元素</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Add elements to the DOM +++</code></pre>
    <p>創建一個新的<code translate="No">&lt;div&gt;</code> DOM中的元素，並分配一個<code translate="No">id</code>值為的屬性<strong>返回鍵</strong>。創建一個新的<code translate="No">&lt;img&gt;</code>元素中的DOM並分配<code translate="No">src</code>屬性以及您的快退按鈕的網址。</p>
    <!-- UPDATE task 2 -->
    
    <h3>將快退按鈕添加到控制欄</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Add rewind button to the control bar +++</code></pre>
    <p>得到<code translate="No">spacer</code>控件欄中的元素，然後向其中添加快退按鈕元素。</p>
    <!-- UPDATE task 3 -->
    
    <h3>收聽快退按鈕</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Listen for the rewind button +++</code></pre>
    <p>到<code translate="No">backButton</code>元素，為添加一個偵聽器<code translate="No">onclick</code>事件。單擊後，使用數據觸發您的自定義事件。</p>
    <!-- UPDATE task 4 -->
    
    <h3>收聽倒帶活動</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Listen for rewind event +++</code></pre>
    <p>用數據監聽您的自定義事件。觸發後，根據<code translate="No">rewindAmt</code>在代碼中定義。</p>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">應用程式樣式</h2>
    <p>CSS用於確定播放器的大小以及控制欄中的倒帶按鈕的位置和大小。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Plugin_code">插件代碼</h2>
    <p>通常，將JavaScript轉換為Brightcove Player插件時，需要進行名義上的更改。一項必需的更改是替換標準的使用<code translate="No">ready()</code>方法與定義插件的代碼。</p>
    <p>這是可以與播放器一起使用的非常常用的JavaScript代碼開始：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
  ...
});</code></pre>
    <p>您將更改第一行以使用標準語法來啟動Brightcove Player插件：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginName', function(options) {
  var myPlayer = this;
  ...
});</code></pre>
    <!-- UPDATE path to plugin's JavaScript -->
    
    <p>如前所述，您可以在該文檔的相應GitHub存儲庫中看到該插件的JavaScript代碼：<a href="https://github.com/BrightcoveLearning/18150-trigger-rewind-custom-event/blob/master/plugin/custom-event.js"> custom-event.js</a>。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Understanding_Custom_events">了解自定義事件</h2>
    <p>使用自定義事件，您可以解耦並消除DOM對象與事件偵聽器之間的依賴關係，從而創建事件驅動的體系結構模型。</p>
    <h3>派遣</h3>
    <p>要調度自定義事件，請使用<code translate="No">trigger()</code>方法如下：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// trigger a custom event
myPlayer.trigger('eventName');
or
// trigger a custom event with data
myPlayer.trigger('eventName', {data: 'some data'});</code></pre>
    <p>有關調度自定義事件的詳細信息，請參見<a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#trigger__anchor">播放器API索引</a>。</p>
    <p>在此示例中，代碼執行以下操作：</p>
    <ul>
      <li>調度名為的自定義事件<code translate="No">rewind</code></li>
      <li>發送名稱為的數據對象<code translate="No">amount</code>和值為<code translate="No">5</code> -您將在JavaScript代碼中看到設置此值的位置</li>
    </ul>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// trigger a custom event with data
myPlayer.trigger('rewind', {'amount': rewindAmount});</code></pre>
    <h3>聽</h3>
    <p>要監聽自定義事件，可以使用<code translate="No">on()</code>方法如下：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// listen for a custom event
player.on('eventName', function(evt){});
or
// listen for a custom event with data
player.on('eventName', function(evt,data){});</code></pre>
    <p>您也可以使用<code translate="No">one()</code>如果您希望事件監聽器僅被觸發一次然後被刪除，則該方法。有關監聽事件的詳細信息，請參閱<a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#on__anchor">播放器API索引</a>。</p>
    <p>在此示例中，代碼執行以下操作：</p>
    <ul>
      <li>監聽一個名為的自定義事件<code translate="No">rewind</code></li>
      <li>將事件和數據對像傳遞給函數</li>
    </ul>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// listen for a custom event with data
 myPlayer.on('rewind',function(evt,data){
});</code></pre>
    <p>當您在控制台中顯示事件和數據對象時，它應類似於以下內容：</p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Custom event data" src="/assets/images/code-samples/brightcove-player-sample-trigger-rewind-custom-event/custom-event-data.png" />
      <figcaption class="bcls-caption--image">自定義事件數據</figcaption>
    </figure>
  </section>
</article>