---
title: '布萊特灣球員樣本：禁用前向清理
description: '在本主題中，您將學習如何使用中間件功能禁用前向擦除，直到播放了指定百分比的視頻。'
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Player_example">播放器示例</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">提供此示例和相關代碼作為生產開發的指南。該代碼未經認證可用於生產用途，也未經官方支持。</aside>
    <p>最初，您將無法向前擦洗，但可以向後擦洗。視頻播放達到50％後，您可以向前或向後滑動。在代碼中可以輕鬆設置何時允許向前擦洗的百分比。</p>
    <!-- UPDATE codepen here -->
    
    <p data-height="452" data-theme-id="34967" data-slug-hash="OvzyMN" data-default-tab="result" data-user="rcrooks1969" data-embed-version="2" data-pen-title="Disable Forward Scrubbing" class="codepen">看筆<a href="https://codepen.io/team/rcrooks1969/pen/OvzyMN/">禁用正向擦洗</a>通過Brightcove學習服務（<a href="https://codepen.io/rcrooks1969"> @ rcrooks1969</a>） 上<a href="https://codepen.io">密碼筆</a>。</p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->
    
    <h3>源代碼</h3>
          <p>觀看<a href="https://github.com/BrightcoveLearning/18571-disable-forward-scrubbing">GitHub上的完整解決方案</a>。</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">使用代碼筆</h2></summary>
      <p>以下是一些有效使用上述 CodePen 的提示：</p>
      <ul>
        <li>通過單擊切換播放器的實際顯示<strong translate="No">結果</strong>按鈕。</li>
        <li>點擊<strong translate="No">HTML/CSS/JS</strong>按鈕以顯示其中一種代碼類型。</li>
        <li>在本文檔的後面部分，應用程序中使用的邏輯、流程和样式將在<a href="#Player/HTML_configuration">播放器/HTML 配置</a> , <a href="#Application_flow">申請流程</a>和<a href="#Application_styling">應用樣式</a>部分。遵循這些部分中的信息的最佳方法是：
          <ol>
            <li>點擊<strong translate="No">在 CODEPEN 上編輯</strong> CodePen 中的按鈕，並在一個瀏覽器/瀏覽器選項卡中提供代碼。</li>
            <li>在CodePen中，調整要顯示的代碼。您可以在CodePen中更改不同代碼段的寬度。</li>
            <li>觀看<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Application_flow">申請流程</a>和/或<a href="#Application_styling">應用程式樣式</a>其他瀏覽器/瀏覽器標籤中的部分。現在，您將能夠按照代碼說明進行操作，同時查看代碼。</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  
  <section class="bcls-section">
    <h2 id="Middleware_functions">中間件功能</h2>
    <p>本示例使用Video.js中間件來實現代碼解決方案。在很高的層次上，中間件最有價值的用例是您想攔截和更改播放器的核心行為，例如設置源或當前時間。通常，在本文檔中沒有詳細討論Video.js中間件，但將解釋用於中間件功能的實際代碼。以下是Video.js來源的文檔，其中詳細介紹了中間件：</p>
    <ul>
      <li><a href="http://docs.videojs.com/tutorial-middleware.html">中間件（來自Video.js文檔集）</a></li>
      <li><a href="http://blog.videojs.com/feature-spotlight-middleware/">功能亮點：中間件（來自Video.js博客）</a></li>
      <li><a href="https://github.com/videojs/videojs-playbackrate-adjuster">videojs-playbackrate-adjuster（示例應用程序）</a></li>
    </ul>
    <h3>使用Brightcove Player實施中間件功能</h3>
    <p>使用中間件功能的最簡單方法是：</p>
    <ol>
      <li>編寫中間件功能。</li>
      <li>將中間件功能放置在頁面上，並將播放器放在<code translate="No">script</code>標籤，或使用<code translate="No">src</code>具有一個屬性<code translate="No">script</code>標籤。兩種實現方式都將在本文檔中顯示。</li>
      <li>使用<code translate="No">use()</code>方法，如下所示：
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.use('mimeType', functionName);</code></pre>
        <p>為了<strong>模仿型</strong>您可以使用標準的視頻模仿類型，例如<strong>視頻/ mp4</strong>，或使用<strong>*</strong>如果您希望中間件功能可以作用於所有mimetypes。</p>
      </li>
    </ol>
  </section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">播放器/ HTML配置</h2>
    <p>本節詳細介紹了播放器創建過程中所需的任何特殊配置。此外，還介紹了除頁面內嵌入播放器實現代碼外，還必須添加到頁面的其他HTML元素。</p>
    <h3>播放程式組態</h3>
    <p>您為此示例創建的Brightcove Player不需要任何特殊配置。</p>
    <h3>其他HTML</h3>
    <p>沒有其他HTML元素添加到頁面。</p>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">申請流程</h2>
    <p>此應用程序背後的基本邏輯是：</p>
    <ul>
      <li>為中間件功能實現基本語法，為功能命名<code translate="No">disableForwardScrubbing</code>。</li>
      <li>實施所需<code translate="No">setSource()</code>方法。</li>
      <li>改變<code translate="No">setCurrentTime()</code>檢查查看器嘗試進行擦洗的時間是否小於播放器中的當前時間的方法，或者向前擦洗百分比已通過的方法。如果任何一個為真，則將播放頭移至該時間。如果為false，請在當前時間繼續播放視頻。</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>創建中間件功能的框架</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Define the middleware function+++</code></pre>
    <p>創建中間件功能的基本語法如下：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">var disableForwardScrubbing = function(player) {
  return {
  ...
};</code></pre>
    <p>請注意<code translate="No">player</code>對像被傳遞給函數。</p>
    <!-- UPDATE task 2 -->
    
    <h3>實施<code translate="No">setSource()</code>方法</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### Implement setSource() ###</code></pre>
    <p>這是每個中間件功能必需的方法。通過使用所示語法，無論視頻類型如何，都將始終選擇中間件：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">setSource: function setSource(srcObj, next) {
  next(null, srcObj);
},</code></pre>
    <!-- UPDATE task 3 -->
    
    <h3>更改setCurrentTime（）方法</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### Alter the setCurrentTime method ###</code></pre>
    <p>該代碼塊是實際的<code translate="No">setCurrentTime()</code>方法已更改。要了解這一點，首先要知道的是<code translate="No">ct</code>傳遞給該函數的value反映了查看者要對其進行擦洗的值。這<code translate="No">if</code>語句檢查新值是否小於播放器的當前時間或是否超出允許向前擦洗的百分比。如果任何一個為true，則返回新值，這將導致播放頭移動到新值。如果條件為假，則表示觀看者試圖在允許之前進行向前擦洗，則返回播放器的當前時間，並且播放不會更改。</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">setCurrentTime: function setCurrentTime(ct) {
  var percentAllowForward = 50,
   // Determine percentage of video played
   percentPlayed = player.currentTime() / player.duration() * 100;
   // Check if the time scrubbed to is less than the current time
   // or if passed scrub forward percentage
  if ( ct &lt; player.currentTime() || percentPlayed &gt; percentAllowForward ) {
    // If true, move playhead to desired time
    return ct;
  }
  // If time scrubbed to is past current time and not passed percentage
  // leave playhead at current time
  return player.currentTime();
}</code></pre>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">應用程式樣式</h2>
    <p>頁面上的CSS只是設置播放器的大小。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Using_the_middleware_function">使用中間件功能</h2>
    <p>一旦編寫了中間件功能，您就想使用它。前面提到了兩種方法，現在將對其進行詳細說明。</p>
    <h3>與播放器在同一頁面上的代碼</h3>
    <p>在這裡，您可以在與播放器相同的頁面上定義中間件功能，然後進行註冊。</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="5701202551001"
  data-account="1752604059001"
  data-player="default"
  data-embed="default"
  data-application-id
  class="video-js"
  controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

<span class="bcls-highlight">&lt;script type="text/javascript"&gt;
  // +++ Define the middleware function+++
  var disableForwardScrubbing = function(player) {
    return {
      // +++ Implement setSource() +++
      setSource: function setSource(srcObj, next) {
        next(null, srcObj);
      },
      // +++ Alter the setCurrentTime method +++
      setCurrentTime: function setCurrentTime(ct) {
        var percentAllowForward = 50,
         // Determine percentage of video played
         percentPlayed = player.currentTime() / player.duration() * 100;
         // Check if the time scrubbed to is less than the current time
         // or if passed scrub forward percentage
        if ( ct &lt; player.currentTime() || percentPlayed &gt; percentAllowForward ) {
          // If true, move playhead to desired time
          return ct;
        }
        // If time scrubbed to is past current time and not passed percentage
        // leave playhead at current time
        return player.currentTime();
      }
    }
  };

  // Register the middleware with the player
  videojs.use('*', disableForwardScrubbing);</span>

&lt;/script&gt;</code></pre>
    <h3>播放器頁面上包含的代碼</h3>
    <p>在以下代碼中，用於中間件功能的JavaScript和<code translate="No">use()</code>註冊方法僅包含在頁面中。</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="5701202551001"
  data-account="1752604059001"
  data-player="default"
  data-embed="default"
  data-application-id
  class="video-js"
  controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

<span class="bcls-highlight">&lt;script src="disable-forward-scrubbing.js"&gt;&lt;/script&gt;</span></code></pre>
    <p>見<a href="https://github.com/BrightcoveLearning/18571-disable-forward-scrubbing/tree/master/function-in-separate-file">單獨文件中的功能</a>有關完整代碼，請參見GitHub存儲庫中的。</p>
  </section>
</article>