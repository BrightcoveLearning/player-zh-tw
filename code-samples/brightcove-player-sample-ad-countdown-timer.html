---
title: '布萊特灣球員樣本：廣告倒計時
description: '在本主題中，您將學習如何為廣告創建倒數計時器。顯示屏將利用Overlay插件。請注意，這在iOS全屏模式下不起作用。見<a href="/playback/ios-and-brightcove-player.html">iOS 和 Brightcove 播放器</a>文檔以獲取完整的詳細信息。
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Player_example">播放器示例</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">提供此示例和相關代碼作為生產開發的指南。該代碼未經認證可用於生產用途，也未經官方支持。</aside>
    <p>對於插播前，插播中和插播後，廣告的倒數計時器將顯示在播放器的左上方。</p>
    <!-- UPDATE codepen here -->
    
    <p class="codepen" data-height="468" data-theme-id="34967" data-default-tab="result" data-user="rcrooks1969" data-slug-hash="rzdXVQ" style="height: 468px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Ad Countdown Timer"><span>看筆<a href="https://codepen.io/team/rcrooks1969/pen/rzdXVQ/">廣告倒數計時器</a>通過Brightcove學習服務（<a href="https://codepen.io/rcrooks1969"> @ rcrooks1969</a>） 上<a href="https://codepen.io">密碼筆</a>。</span></p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script>
    
    <h3>源代碼</h3>
          <p>觀看<a href="https://github.com/BrightcoveLearning/18188-ad-countdown-timer">GitHub上的完整解決方案</a>。</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">使用代碼筆</h2></summary>
      <p>以下是一些有效使用上述 CodePen 的提示：</p>
      <ul>
        <li>通過單擊切換播放器的實際顯示<strong translate="No">結果</strong>按鈕。</li>
        <li>點擊<strong translate="No">HTML / CSS / JS</strong>按鈕顯示一種代碼類型。</li>
        <li>在本文檔的後面，將在應用程序中討論該應用程序中使用的邏輯，流程和样式。<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Application_flow">申請流程</a>和<a href="#Application_styling">應用程式樣式</a>部分。遵循這些部分中的信息的最佳方法是：
          <ol>
            <li>點擊<strong translate="No">在CODEPEN上編輯</strong>按鈕並在一個瀏覽器/瀏覽器選項卡中提供代碼。</li>
            <li>在CodePen中，調整要顯示的代碼。您可以在CodePen中更改不同代碼段的寬度。</li>
            <li>觀看<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Application_flow">申請流程</a>和/或<a href="#Application_styling">應用程式樣式</a>其他瀏覽器/瀏覽器標籤中的部分。現在，您將能夠按照代碼說明進行操作，同時查看代碼。</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Development_sequence">開發順序</h2></summary> 
      <p>這是推薦的開發順序：</p>
      <ol>
        <li>使用頁內嵌入播放器實現來測試播放器，插件和CSS的功能（如果需要CSS）</li>
        <li>將插件的JavaScript和CSS放入單獨的文件中以進行本地測試</li>
        <li>解決任何錯誤後，將插件代碼和CSS部署到服務器上</li>
        <li>使用Studio將插件和CSS添加到播放器</li>
        <li>如果您確定iframe實現更合適，請替換頁內嵌入播放器實現（在下一部分中詳細介紹）</li>
      </ol>
      <p>有關這些步驟的詳細信息，請查看<a href="/coding-topics/step-step-plugin-development.html">一步步：插件開發</a>指導。</p>
      <h3>iframe或頁內嵌入</h3>
      <p>在開發Brightcove Player的增強功能時，您需要確定代碼是否最適合iframe或頁內嵌入實施。最佳實踐建議是構建一個可與iframe實現配合使用的插件。使用iframe播放器的優點是：</p>
      <ul>
        <li>與現有的JavaScript和/或CSS無衝突</li>
        <li>自動響應</li>
        <li>iframe可簡化在社交媒體應用中的使用（或需要將視頻“傳播"到其他應用中的任何時候）</li>
      </ul>
      <p>儘管集成頁內嵌入播放器可能會更加複雜，但是有時您會圍繞該實現計劃代碼。概括地說，當包含頁面需要與播放器進行通信時，這種方法是最好的。具體來說，以下是一些示例：</p>
      <ul>
        <li>包含頁面中的代碼需要偵聽播放器事件並對其進行操作</li>
        <li>播放器使用包含頁面中的樣式</li>
        <li>iframe將導致應用邏輯失敗，例如從包含頁面的重定向</li>
      </ul>
      <p>即使最終實現未使用iframe代碼，您仍可以將頁內嵌入代碼與JavaScript插件和CSS單獨文件一起使用。這封裝了您的邏輯，以便您可以輕鬆地在多個播放器中使用它。</p>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="API/Plugin_resources_used">使用的API /插件資源</h2>
    <!-- UPDATE table, remove unneeded columns -->
    
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>API方法</th>
          <th>API事件</th>
          <th>Brightcove 播放器插件</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td>ima3.adPlayer.duration()</td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#event:loadedmetadata__anchor">載入的詮釋資料</a> </td>
          <td><a href="/plugins/advertising-ima3-plugin.html">IMA3插件</a></td>
        </tr>
        <tr>
          <td>ima3.adPlayer.currentTime()</td>
          <td><a href="/plugins/advertising-ima3-plugin.html#Events">ima3開始</a></td>
          <td><a href="/plugins/display-overlay-plugin.html">疊加式插件</a></td>
        </tr>
        <tr>
          <td><a translate="No" href="https://docs.brightcove.com/brightcove-player/current-release/EventTarget.html#on__anchor">上（）</a></td>
          <td><a href="/plugins/advertising-ima3-plugin.html#Events">ima3完成</a></td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td><a href="/plugins/advertising-ima3-plugin.html#Events">跳過廣告</a></td>
          <td>&nbsp;</td>
        </tr>
      </tbody>
    </table>
  </section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">播放器/ HTML配置</h2>
    <p>本節詳細介紹了播放器創建過程中所需的任何特殊配置。此外，還介紹了除頁面內嵌入播放器實現代碼外，還必須添加到頁面的其他HTML元素。</p>
    <h3>播放程式組態</h3>
    <p>IMA3插件在Studio中的配置如下：</p>
    <figure class="bcls-figure"><img class="bcls-image" alt="Configure IAM3 plugin" src="/assets/images/code-samples/ad-countdown-sample/configure-ima.png" /></figure>
    <aside class="bcls-aside bcls-aside--tip">
      <p><strong>儘管覆蓋插件已在代碼中配置</strong>，您還可以使用Studio執行相同的任務：</p>
      <figure class="bcls-figure"><img class="bcls-image" alt="Configure Overlay plugin" src="/assets/images/code-samples/ad-countdown-sample/configure-overlay.png" /></figure>
      <p>當然，您將隨後從樣本中刪除等效代碼。</p>
    </aside>
    <h3>其他HTML</h3>
    <p>疊加插件的JavaScript和CSS文件將導入到頁面中。</p>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">申請流程</h2>
    <p>此應用程序背後的基本邏輯是：</p>
    <ul>
      <li>在Studio中配置了IMA3插件。</li>
      <li>覆蓋插件被調用和配置。</li>
      <li>廣告開始時，會顯示疊加層，並且每秒都會調用一個函數，將剩餘時間注入到疊加層中。</li>
      <li>停止廣告或跳過廣告時，重疊式廣告會被隱藏，並且會對其進行一些清理。</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>將時間轉換為秒，不帶小數</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### +++ Helpful method to convert seconds +++ ###</code></pre>
    <p>此輔助函數需要花費時間，其中可能包含小時，分鐘和秒，並且可以簡單地轉換為秒。</p>
    <!-- UPDATE task 2 -->
    
    <h3>設置監聽廣告事件</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// +++ Start counter on start of ad +++</code></pre>
    和
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// +++ Listen for ad end or skipped +++</code></pre>
    <p>將廣告和視頻信息加載到播放器中後，您知道等待<code translate="No">loadedmetadata</code>，您可以使用<code translate="No">on()</code>聽的方法<code translate="No">ima3-started</code>，<code translate="No">ima3-complete</code>和<code translate="No">ads-ad-skipped</code>。</p>
    <!-- UPDATE task 3 -->
    
    <h3>在廣告開始時顯示重疊式廣告</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// +++ Start counter on start of ad +++</code></pre>
    <p>將一個類添加到疊加層以進行樣式設置，顯示疊加層，然後使用JavaScript的<code translate="No">setInterval()</code>方法用於調用自定義<code translate="No">everySecond()</code>方法。在裡面<code translate="No">everySecond()</code>方法，從持續時間中減去廣告的當前播放時間，並將格式化後的結果注入到重疊式廣告中。</p>
    <!-- UPDATE task 3 -->
    
    <h3>隱藏完成或跳過的廣告上的重疊式廣告</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// +++ Listen for ad end or skipped +++</code></pre>
    <p>這兩個可能會終止廣告的廣告事件都調用了一個名為<code translate="No">videoCompleteOrSkipped</code>。在此函數中，一個名為<code translate="No">theInterval</code>，是由先前稱為<code translate="No">setInterval()</code>，需要由JavaScript清除<code translate="No">clearInterval()</code>方法。這是需要的，因為間隔時間佔用了處理時間。最後，覆蓋層被隱藏，所有註入的HTML都被清除。</p>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">應用程式樣式</h2>
    <p>CSS用於對顯示倒數計時器的疊加層的外觀進行樣式設置。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Plugin_code">插件代碼</h2>
    <p>通常，將JavaScript轉換為Brightcove Player插件時，需要進行名義上的更改。一項必要的更改是替換標準版的<code translate="No">ready()</code>定義插件的代碼的方法。</p>
    <p>這是可以與播放器一起使用的非常常用的JavaScript代碼開始：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
  ...
});</code></pre>
    <p>您將更改第一行以使用標準語法來啟動Brightcove Player插件：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginName', function(options) {
  var myPlayer = this;
  ...
});</code></pre>
    <!-- UPDATE path to plugin's JavaScript -->
    
    <p>如前所述，您可以在該文檔的相應GitHub存儲庫中看到該插件的JavaScript代碼：<a href="//github.com/BrightcoveLearning/18188-ad-countdown-timer/blob/master/plugin/adCountdown.js"> adCountdown.js</a>。</p>
    <h3>與播放器一起使用插件</h3>
    <p>將插件的CSS和JavaScript文件存儲在Internet上可訪問的位置後，即可將其與播放器一起使用。在Studio的<strong>選手們</strong>您可以選擇一個播放器模塊，然後在<strong>插件</strong>部分將網址添加到CSS和JavaScript文件中，並添加<strong>名稱</strong>和<strong>選項</strong>，如果需要選項。</p>
    <aside class="bcls-aside bcls-aside--tip">有關使用 Studio 為玩家指定外掛程式的詳細資訊，請參閱<a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">設定播放程式外掛程式</a>文件。</aside> 
  </section>
</article>
