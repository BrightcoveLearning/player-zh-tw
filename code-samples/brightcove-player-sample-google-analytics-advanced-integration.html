---
title: '布萊特灣球員樣本：谷歌分析高級集成
description: '在本主題中，您將了解如何在使用 Brightcove 播放器時在運行時動態設置 Google Analytics 跟踪 ID。'
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="Player_example">播放器示例</h2>
<!-- UPDATE description -->

<aside class="bcls-aside bcls-aside--information">提供此示例和相關代碼作為生產開發的指南。該代碼未經認證可用於生產用途，也未經官方支持。</aside>

<p>本示例使用Brightcove播放器並以編程方式添加Google Analytics（分析），並在運行時動態分配跟踪ID。如果您有多個Google Analytics（分析）帳戶，但又不想為每個帳戶指定唯一的參與者，則此方法很有用。</p>
<p>
   動態添加GA時，您不會在Video Cloud Studio中添加Google Analytics（分析）插件。如果您在Studio中對其進行配置，則會在播放器加載時對其進行初始化，並且更改設置為時已晚（不能覆蓋它們）。
</p>
<p>
這種方法的另一個好處是，我們的API集成不會在您的Google Analytics（分析）帳戶中創建字段（Google不會讓您重命名現有字段）。
</p>
<p>
  當您更換<code translate="No">tracker</code>在此示例中使用您自己的Google Analytics（分析）跟踪ID值，那麼您應該在Google Analytics（分析）頁面上看到指標。
</p>
<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Google Analytics home page" src="/assets/images/code-samples/brightcove-player-sample-google-analytics-advanced-integration/ga-home.png" />
  <figcaption class="bcls-caption--image">Google Analytics（分析）主頁</figcaption>
</figure>

<!-- UPDATE codepen here -->
<p class="codepen" data-height="465" data-theme-id="34967" data-default-tab="result" data-user="bcls1969" data-slug-hash="wvaQwRy" style="height: 465px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Google Analytics Advanced Integration">
  <span>看筆<a href="https://codepen.io/team/bcls1969/pen/wvaQwRy">Google Analytics（分析）高級集成</a>通過Brightcove學習服務（<a href="https://codepen.io/team/rcrooks1969"> @ bcls1969</a>） 上<a href="https://codepen.io">密碼筆</a>。</span>
</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>
<br/>

<h3>源代碼</h3>
<!-- UPDATE link to GitHub source -->
<p>
  您可以通過選擇<strong>的HTML</strong>，<strong>的CSS</strong>和<strong>JS</strong>按鈕或上方的CodePen中的按鈕<a href="https://github.com/BrightcoveLearning/google-analytics-advanced-integration">GitHub上的完整解決方案</a>。 
</p>
</section>

<section class="bcls-section">
<h2 id="Using_the_CodePen" class="bcls-expander-head">使用代碼筆</h2>

<div class="bcls-expander-content">
<p>以下是一些有效使用上述 CodePen 的提示：</p>

<ul>
	<li>通過單擊切換播放器的實際顯示<strong>結果</strong>按鈕。</li>
	<li>點擊<strong>HTML / CSS / JS</strong>按鈕顯示一種代碼類型。</li>
	<li>在本文檔的後面，將在應用程序中討論該應用程序中使用的邏輯，流程和样式。<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Applicaton_flow">申請流程</a>和<a href="#Application_styling">應用程式樣式</a>部分。遵循這些部分中的信息的最佳方法是：
	<ol>
		<li>點擊<strong>在CODEPEN上編輯</strong>按鈕並在一個瀏覽器/瀏覽器選項卡中提供代碼。</li>
		<li>在CodePen中，調整要顯示的代碼。您可以在CodePen中更改不同代碼段的寬度。</li>
		<li>觀看<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Applicaton_flow">申請流程</a>和/或<a href="#Application_styling">應用程式樣式</a>其他瀏覽器/瀏覽器標籤中的部分。現在，您將能夠按照代碼說明進行操作，同時查看代碼。</li>
	</ol>
	</li>
</ul>
</div>
</section>

<section class="bcls-section">
<h2 id="developmentsequence" class="bcls-expander-head">開發順序</h2>

<div class="bcls-expander-content">
<p>這是推薦的開發順序：</p>

<ol>
	<li>使用頁內嵌入播放器實現來測試播放器，插件和CSS的功能（如果需要CSS）</li>
	<li>將插件的JavaScript和CSS放入單獨的文件中以進行本地測試</li>
	<li>解決任何錯誤後，將插件代碼和CSS部署到服務器上</li>
	<li>使用Studio將插件和CSS添加到播放器</li>
	<li>如果您確定iframe實現更合適，請替換頁內嵌入播放器實現（在下一部分中詳細介紹）</li>
</ol>

<p>有關這些步驟的詳細信息，請查看<a href="https://player.support.brightcove.com/coding-topics/step-step-plugin-development.html">一步步：插件開發</a>指導。</p>

<h3>iframe或頁內嵌入</h3>

<p>在開發Brightcove播放器的增強功能時，您需要確定代碼是否最適合iframe或頁內嵌入實施。最佳實踐建議是構建一個可與iframe實現配合使用的插件。使用iframe播放器的優點是：</p>

<ul>
	<li>與現有的JavaScript和/或CSS無衝突</li>
	<li>自動響應</li>
	<li>iframe可簡化在社交媒體應用中的使用（或需要將視頻“傳播"到其他應用中的任何時候）</li>
</ul>

<p>儘管集成頁內嵌入播放器可能會更加複雜，但是有時您會圍繞該實現計劃代碼。概括地說，當包含頁面需要與播放器進行通信時，這種方法是最好的。具體來說，以下是一些示例：</p>

<ul>
	<li>包含頁面中的代碼需要偵聽播放器事件並對其進行操作</li>
	<li>播放器使用包含頁面中的樣式</li>
	<li>iframe將導致應用邏輯失敗，例如從包含頁面的重定向</li>
</ul>

<p>即使最終實現未使用iframe代碼，您仍可以將頁內嵌入代碼與JavaScript插件和CSS單獨文件一起使用。這封裝了你的邏輯，以便您可以輕鬆地在多個玩家中使用它。</p>
</div>
<!-- id="expanderContent" --></section>

<section class="bcls-section">
<h2 id="API/Plugin_resources_used">使用的API /插件資源</h2>
<!-- UPDATE table, remove unneeded columns -->

<table class="bcls-table">
	<thead class="bcls-table__head">
		<tr>
			<th>API方法</th>
			<th>API事件</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><a href="https://player.support.brightcove.com/plugins/plugin-registry.html">bcGa（）</a></td>
      <td>&nbsp;</td>
		</tr>
	</tbody>
</table>
</section>
<!-- UPDATE player and HTML configuration -->

<section class="bcls-section">
<h2 id="Player/HTML_configuration">播放器/ HTML配置</h2>

<p>本節詳細介紹了播放器創建過程中所需的任何特殊配置。此外，還介紹了除頁面內嵌入播放器實現代碼外，還必須添加到頁面的其他HTML元素。</p>

<h3>播放程式組態</h3>
<p>
  此示例使用Brightcove播放器。
</p>
<ol class="bcls-tasklist-restart">
	<li>在 Video Cloud Studio 中，導航到<strong>球員</strong>模塊。創建一個新的播放器。</li>
  <li>
    <p>在左側導航欄中，展開<strong>第三方分析</strong>。為了<strong>谷歌分析</strong>選項，<strong>不要</strong>選擇<strong>啟用Google Analytics（分析）</strong>。取消選中此選項。 </p>
    <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Google Analytics in Studio" src="/assets/images/code-samples/brightcove-player-sample-google-analytics-advanced-integration/enable-ga.png" />
    	<figcaption class="bcls-caption--image">Studio中的Google Analytics（分析）</figcaption>
    </figure>
  </li>
</ol>

<h3 id="Other_HTML">其他HTML</h3>
<p>
  Brightcove Player嵌入代碼後添加了一個腳本。
</p>
<ol class="bcls-tasklist-restart">
	<li>
    <p>
      播放器嵌入代碼後，為Brightcove Google Analytics（分析）插件添加以下腳本。我們正在手動加載插件，而不是在Video Cloud Studio中對其進行配置。
    </p>
    <pre>
    <code class="language-javascript" translate="No">&lt;script src=&quot;//players.brightcove.net/videojs-bc-ga/1/videojs-bc-ga.min.js&quot;&gt;&lt;/script&gt;</code></pre>
  </li>
</ol>
</section>
<!-- UPDATE application flow -->

<section class="bcls-section">
<h2 id="Application_flow">申請流程</h2>

<p>此應用程序背後的基本邏輯是：</p>

<ul>
	<li>在不配置Google Analytics（分析）插件的情況下創建Brightcove Player</li>
	<li>手動加載Google Analytics（分析）插件</li>
  <li>定義插件的選項，包括要跟踪的參數和事件</li>
  <li>設置跟踪ID</li>
  <li>播放影片</li>
</ul>
<!-- UPDATE task 1 -->
<ol class="bcls-tasklist-restart">
	<li>
    <h4>創建播放器</h4>
    <p>
      如果您已經這樣做，請參閱<a href="#Player/HTML_configuration">播放器/ HTML配置</a>上面的部分在Studio中創建您的播放器。
    </p>
  </li>
  <li>
    <h4>
      加載插件
    </h4>
    <p>
      見<a href="#Other_HTML">其他HTML</a>上面的部分添加Google Analytics（分析）插件腳本。
    </p>
  </li>
  <li>
    <h4>
      定義插件選項
    </h4>
    <p>
      在裡面<strong>JS</strong>在CodePen的“代碼"部分中，找到標有以下代碼的代碼：
    </p>
    <pre>
    <code class="language-javascript" translate="No">// Set up the Google Analytics plugin options</code></pre>
    <p>
      玩家呼叫<a href="https://player.support.brightcove.com/plugins/plugin-registry.html">bcGa（）方法</a>初始化插件。請注意，您可以設置要跟踪的參數和事件。
    </p>
<pre class="line-numbers">
<code class="language-javascript" translate="No">myPlayer.bcGa({
  &quot;paramsToTrack&quot;: {
    &quot;bcvideo_video_seconds_viewed&quot;: &quot;dimension7&quot;,
    &quot;bcvideo_range&quot;: &quot;dimension8&quot;,
    &quot;bcvideo_video_duration&quot;: &quot;dimension9&quot;,
    &quot;bcvideo_player&quot;: &quot;dimension10&quot;,
    &quot;bcvideo_account&quot;: &quot;dimension11&quot;,
    &quot;bcvideo_session&quot;: &quot;dimension12&quot;,
    &quot;bcvideo_platform_version&quot;: &quot;dimension13&quot;
  },
  &quot;eventsToTrack&quot;: {
    &quot;video_impression&quot;: &quot;Video Impression&quot;,
    &quot;play_request&quot;: &quot;Play Request&quot;,
    &quot;video_engagement&quot;: &quot;Video Engagement&quot;,
    &quot;ad_start&quot;: &quot;Ad Start&quot;,
    &quot;ad_end&quot;: &quot;Ad End&quot;,
    &quot;player_load&quot;: &quot;Player Load&quot;,
    &quot;error&quot;: &quot;Error&quot;
  },
  &quot;tracker&quot;: &quot;UA-150904906-1&quot;
})
/*
	Two extra events can be added:
		video_view
		video_complete
*/</code></pre>
<p>
  有關事件和維度的詳細信息，請參見<a href="https://studio.support.brightcove.com/players/configuring-google-analytics-event-tracking.html#events">配置Google Analytics（分析）事件跟踪</a>文檔。
</p>
  </li>
  <li>
    <h4>
      設置跟踪ID
    </h4>
    <p>
      在上面的JavaScript代碼中，替換<code translate="No">tracker</code>您的Google Analytics（分析）跟踪ID的值。
    </p>
    <pre>
    <code class="language-javascript" translate="No">&quot;tracker&quot;: &quot;<span class="bcls-input">your tracking id</span>&quot;</code></pre>
  </li>
  <li>
    <p>
      將HTML和JavaScript代碼放在您的網頁上，然後播放視頻。您應該在自己的帳戶中看到指標
    </p>
  </li>
</ol>

</section>
<!-- UPDATE CSS description -->

<!-- <section class="bcls-section">
<h2 id="Application_styling">Application styling</h2>

<p>The CSS positions the player to cover the entire background of the web page. It also positions and styles the text block which sits on top of the player.</p>
</section> -->

<section class="bcls-section">
<h2 id="Plugin_code">插件代碼</h2>

<p>通常，將JavaScript轉換為Brightcove Player插件時，需要進行名義上的更改。一項必需的更改是替換標準的使用<code translate="No">ready()</code>方法與定義插件的代碼。</p>

<p>這是可以與播放器一起使用的非常常用的JavaScript代碼開始：</p>

<pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
  ...
});</code></pre>

<p>您將更改第一行以使用標準語法來啟動Brightcove Player插件：</p>

<pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginName', function(options) {
  var myPlayer = this;
  ...
});</code></pre>
<!-- UPDATE path to plugin's JavaScript -->

<p>如前所述，您可以在該文檔的相應GitHub存儲庫中看到該插件的JavaScript代碼：<a href="https://github.com/BrightcoveLearning/google-analytics-advanced-integration/blob/master/plugin/advanced-ga.js"> advanced-ga.js</a>。</p>

<h3>與播放器一起使用插件</h3>

<p>將插件的CSS和JavaScript文件存儲在Internet上可訪問的位置後，即可將其與播放器一起使用。在工作室的<strong>球員</strong>模塊你可以選擇一個播放器，然後在<strong>插件</strong>部分將 URL 添加到 CSS 和 JavaScript 文件，並添加<strong>姓名</strong>和<strong>選項</strong> , 如果需要選項。</p>

<aside class="bcls-aside bcls-aside--tip">有關使用 Studio 為玩家分配插件的更多信息，請參閱<a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">配置播放器插件</a>文檔。</aside>
</section>
</article>