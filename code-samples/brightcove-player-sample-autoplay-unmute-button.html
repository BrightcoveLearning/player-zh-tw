---
title: '布萊特灣球員樣本：使用取消靜音按鈕自動播放
description: '在本主題中，您將學習如何在所有平台和設備上自動啟動視頻。如果在 iOS 或 Safari 上，視頻將開始靜音，並且將顯示一個按鈕，單擊該按鈕將取消視頻靜音。
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <aside class="bcls-aside bcls-aside--information">自 2018 年 4 月起，Chrome 已停止自動播放未靜音的視頻。請注意，在某些特殊情況下，Chrome可能會自動播放未靜音的視頻。查看谷歌的<a href="https://developers.google.com/web/updates/2017/09/autoplay-policy-changes">自動播放策略更改</a>文檔以獲取完整詳細信息。
    <h2 id="Player_example">播放器示例</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">提供此示例和相關代碼作為生產開發的指南。該代碼未經認證可用於生產用途，也未經官方支持。</aside>
    <p>以下視頻的運行方式會有所不同，具體取決於您運行該視頻的瀏覽器/平台。如果視頻將自動播放音頻，那麼它會自動播放。如果沒有，您將看到視頻開始播放，但是會出現一個取消靜音按鈕。如果單擊該按鈕，您將聽到視頻的音頻。通常，在使用iOS，Safari或Chrome瀏覽器時，如果視頻未靜音，則視頻不會自動播放。該示例演示了一種自動播放視頻的方法，並提供了一個明顯的取消靜音按鈕。</p>
    <p>如果您使用的是IMA3前置廣告，則需要查看<a href="#Using_a_pre-roll_ad">使用片頭廣告</a>本文檔中的“小節"。本部分詳細說明了您需要對以下CodePen中顯示的代碼進行的細微更改，以使該功能與IMA前置廣告一起使用。</p>
    <!-- UPDATE codepen here -->
    
    <p data-height="456" data-theme-id="34967" data-slug-hash="jzmWzL" data-default-tab="result" data-user="rcrooks1969" data-embed-version="2" data-pen-title="Autoplay with Unmute Button" class="codepen">看筆<a href="https://codepen.io/team/rcrooks1969/pen/jzmWzL/">使用取消靜音按鈕自動播放</a>通過Brightcove學習服務（<a href="https://codepen.io/rcrooks1969"> @ rcrooks1969</a>） 上<a href="https://codepen.io">密碼筆</a>。</p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script>
    
    <h3>源代碼</h3>
          <p>觀看<a href="https://github.com/BrightcoveLearning/18567-autoplay-unmute-button">GitHub上的完整解決方案</a>。</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">使用代碼筆</h2></summary>
      <p>以下是一些有效使用上述 CodePen 的提示：</p>
      <ul>
        <li>通過單擊切換播放器的實際顯示<strong translate="No">結果</strong>按鈕。</li>
        <li>點擊<strong translate="No">HTML/CSS/JS</strong>按鈕以顯示其中一種代碼類型。</li>
        <li>在本文檔的後面部分，應用程序中使用的邏輯、流程和样式將在<a href="#Player/HTML_configuration">播放器/HTML 配置</a> , <a href="#Application_flow">申請流程</a>和<a href="#Application_styling">應用樣式</a>部分。遵循這些部分中的信息的最佳方法是：
          <ol>
            <li>點擊<strong translate="No">在 CODEPEN 上編輯</strong> CodePen 中的按鈕，並在一個瀏覽器/瀏覽器選項卡中提供代碼。</li>
            <li>在CodePen中，調整要顯示的代碼。您可以在CodePen中更改不同代碼段的寬度。</li>
            <li>觀看<a href="#Player/HTML_configuration">播放器/ HTML配置</a>，<a href="#Application_flow">申請流程</a>和/或<a href="#Application_styling">應用程式樣式</a>其他瀏覽器/瀏覽器標籤中的部分。現在，您將能夠按照代碼說明進行操作，同時查看代碼。</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Development_sequence">開發順序</h2></summary> 
      <p>這是推薦的開發順序：</p>
      <ol>
        <li>使用頁內嵌入播放器實現來測試播放器，插件和CSS的功能（如果需要CSS）</li>
        <li>將插件的JavaScript和CSS放入單獨的文件中以進行本地測試</li>
        <li>解決任何錯誤後，將插件代碼和CSS部署到服務器上</li>
        <li>使用Studio將插件和CSS添加到播放器</li>
        <li>如果您確定iframe實現更合適，請替換頁內嵌入播放器實現（在下一部分中詳細介紹）</li>
      </ol>
      <p>有關這些步驟的詳細信息，請查看<a href="/coding-topics/step-step-plugin-development.html">一步步：插件開發</a>指導。</p>
      <h3>iframe或頁內嵌入</h3>
      <p>在開發Brightcove Player的增強功能時，您需要確定代碼是否最適合iframe或頁內嵌入實施。最佳實踐建議是構建一個可與iframe實現配合使用的插件。使用iframe播放器的優點是：</p>
      <ul>
        <li>與現有的JavaScript和/或CSS無衝突</li>
        <li>自動響應</li>
        <li>iframe可簡化在社交媒體應用中的使用（或需要將視頻“傳播"到其他應用中的任何時候）</li>
      </ul>
      <p>儘管集成頁內嵌入播放器可能會更加複雜，但是有時您會圍繞該實現計劃代碼。概括地說，當包含頁面需要與播放器進行通信時，這種方法是最好的。具體來說，以下是一些示例：</p>
      <ul>
        <li>包含頁面中的代碼需要偵聽播放器事件並對其進行操作</li>
        <li>播放器使用包含頁面中的樣式</li>
        <li>iframe將導致應用邏輯失敗，例如從包含頁面的重定向</li>
      </ul>
      <p>即使最終實現未使用iframe代碼，您仍可以將頁內嵌入代碼與JavaScript插件和CSS單獨文件一起使用。這封裝了你的邏輯，以便您可以輕鬆地在多個玩家中使用它。</p>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="API/Plugin_resources_used">使用的API /插件資源</h2>
    <!-- UPDATE table, remove unneeded columns -->
    
    <table class="bcls-table">
      <thead class="bcls-table__head">
        <tr>
          <th>API方法</th>
          <th>API事件</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#muted">靜音（）</a></td>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#event:loadedmetadata">加載元數據</a></td>
        </tr>
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#play">玩（）</a></td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/module-events.html#.on">上（）</a></td>
          <td>&nbsp;</td>
        </tr>
        <tr>
          <td><a href="https://docs.brightcove.com/brightcove-player/current-release/Player.html#volume">體積（）</a></td>
          <td>&nbsp;</td>
        </tr>
      </tbody>
    </table>
    <!-- <aside class="bcls-aside bcls-aside--tip">This code sample uses one of the Brightcove REST APIs. To understand working with this API it is vital you read and understand the <a href="/getting-started/learning-guide-using-rest-apis.html">Learning Guide: Using the REST APIs</a> document.</aside> --></section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">播放器/ HTML配置</h2>
    <p>本節詳細介紹了播放器創建過程中所需的任何特殊配置。此外，還介紹了除頁面內嵌入播放器實現代碼外，還必須添加到頁面的其他HTML元素。</p>
    <h3>播放程式組態</h3>
    <p>除了標準包含<code translate="No">id</code>在裡面<code translate="No">video</code>標籤，<code translate="No">playsinline</code>為iOS功能添加了屬性：</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;div id="playerContainer" class="outer"&gt;
   &lt;video-js <span class="bcls-highlight">id="myPlayerID"</span>
     data-video-id="5755775186001"
     data-account="1752604059001"
     data-player="default"
     data-embed="default"
     data-application-id
     class="video-js"
     controls
     <span class="bcls-highlight">playsinline</span>&gt;&lt;/video-js&gt;
&lt;/div&gt;</code></pre>
    <h3>其他HTML</h3>
    <p>除上一節中提到的HTML元素外，沒有其他HTML元素被添加到頁面中。</p>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">申請流程</h2>
    <p>此應用程序背後的基本邏輯是：</p>
    <ul>
      <li>使用<code translate="No">play()</code>嘗試播放視頻的方法。對該方法的調用分配給一個變量，該變量將保存JavaScript返回的值<a href="/playback/autoplay-considerations.html#Programmatic_autoplay_detection">承諾</a>。</li>
      <li>如果承諾得到解決（正在播放視頻），請取消播放器靜音並設置音量。</li>
      <li>如果承諾被拒絕（視頻未播放），請執行以下操作：
        <ul>
          <li>使播放器靜音，然後開始播放視頻（由於播放器已靜音，現在將執行此操作）。</li>
          <li>動態創建一個HTML按鈕元素，該元素用作<strong>取消靜音</strong>按鈕。</li>
          <li>添加一個&nbsp;<code translate="No">click</code>按鈕上的事件偵聽器。</li>
          <li>配置按鈕的文本，樣式等。</li>
          <li>將按鈕放在播放器上。</li>
        </ul>
      </li>
    </ul>
    <h3>嘗試播放視頻</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### Wait for loadedmetadata then try to play video ###</code></pre>
    <p>按照標準程序，您需要等待<code translate="No">loadedmetadata</code>使用之前的事件<code translate="No">play()</code>方法。從方法調用返回的承諾存儲在<code translate="No">promise</code>多變的。如果正在播放視頻，則可以取消播放器靜音並設置音量。</p>
    <h3>禁止自動播放時，將播放器靜音並播放視頻</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### If autoplay prevented: mute the video, play video and display unmute button ###</code></pre>
    <p>在這裡<code translate="No">catch</code>承諾邏輯可讓您在播放器中視頻未開始播放時採取行動。播放器已通過編程方式靜音，因此將播放視頻。這<code translate="No">play()</code>再次調用方法，這將開始播放視頻。按照此代碼，將動態創建和配置按鈕。</p>
    <h3>添加一個<code translate="No">click</code>按鈕的事件監聽器</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### Add button's event listener ###</code></pre>
    <p>使用JavaScript的<code translate="No">addEventListener()</code>，則會動態創建點擊事件處理程序。在事件處理程序中，將播放器取消靜音，設置音量級別，最後將按鈕從DOM中移除。</p>
    <!-- UPDATE task 3 -->
    
    <h3>配置按鈕</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ###  Configure the button ###</code></pre>
    <p>在此代碼部分中，設置了按鈕的標籤，配置了按鈕的外觀，並且<code translate="No">class</code>添加了用於放置按鈕的CSS參考。</p>
    <!-- UPDATE task 3 -->
    
    <h3>將按鈕添加到容器</h3>
    <p>找到標有以下代碼的代碼：</p>
    <pre>
<code class="language-javascript" translate="No">// ### Add the button to the container ###</code></pre>
    <p>單行代碼將按鈕放置在<code translate="No">div</code>限制了玩家。</p>
    <!-- UPDATE task 3 --></section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Using_a_pre-roll_ad">使用片頭廣告</h2>
    <p>由於在顯示取消靜音按鈕時正在播放廣告，因此您需要取消靜音廣告播放器而不是內容播放器。為此，您可以將以下內容用於點擊處理程序：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">button.addEventListener("click", function() {
  <span class="bcls-highlight">myPlayer.ima3.adPlayer.muted(false);
  myPlayer.ima3.adPlayer.volume(volumeLevel);</span>
  //myPlayer.muted(false);
  //myPlayer.volume(volumeLevel);
  playerContainer.removeChild(button);
}</code></pre>
    <p>內容播放器音量控制的兩行代碼被註釋掉了，而留在裡面只是為了比較。</p>
    <p>您無需對非iOS / Safari / Chrome瀏覽器代碼進行相同的更改，因為在加載廣告之前（在<code translate="No">loadstart</code>事件），並且這些更改會在廣告播放器加載時傳遞給廣告播放器。</p>
    <p>看到這個<a href="https://codepen.io/team/rcrooks1969/pen/xWzPJX">密碼筆</a>一個可行的例子。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Application_styling">應用程式樣式</h2>
    <p>三個CSS選擇器執行以下操作：</p>
    <ul>
      <li>設置視頻<code translate="No">height</code>和<code translate="No">width</code>至<strong>100％</strong>裝滿放置它的容器。</li>
      <li>創建與<code translate="No">div</code>環繞播放器。所使用的值對應於播放器的大小。</li>
      <li>創建另一個類選擇器，將取消靜音按鈕放置在<code translate="No">div</code>環繞播放器。</li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Plugin_code">插件代碼</h2>
    <p>通常，將JavaScript轉換為Brightcove Player插件時，需要進行名義上的更改。一項必需的更改是替換標準的使用<code translate="No">ready()</code>方法與定義插件的代碼。</p>
    <p>這是可以與播放器一起使用的非常常用的JavaScript代碼開始：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
  ...
});</code></pre>
    <p>您將更改第一行以使用標準語法來啟動Brightcove Player插件：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('pluginName', function(options) {
  var myPlayer = this;
  ...
});</code></pre>
    <!-- UPDATE path to plugin's JavaScript -->
    
    <p>如前所述，您可以在該文檔的相應GitHub存儲庫中看到該插件的JavaScript代碼：<a href="https://github.com/BrightcoveLearning/18567-autoplay-unmute-button-iossafari/blob/master/plugin/unmute-button.js"> unmute-button.js</a>。</p>
    <h3>與播放器一起使用插件</h3>
    <p>將插件的CSS和JavaScript文件存儲在Internet上可訪問的位置後，即可將其與播放器一起使用。在工作室的<strong>球員</strong>模塊你可以選擇一個播放器，然後在<strong>插件</strong>部分將 URL 添加到 CSS 和 JavaScript 文件，並添加<strong>姓名</strong>和<strong>選項</strong> , 如果需要選項。</p>
    <aside class="bcls-aside bcls-aside--tip">有關使用 Studio 為玩家分配插件的更多信息，請參閱<a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">配置播放器插件</a>文檔。</aside>
  </section>
</article>
