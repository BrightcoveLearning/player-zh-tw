---
title:延遲播放器實例化
parent: 'Publishing Videos &amp; Players'
description: In this topic, you will learn how to delay instantiation of Brightcove Player when an HTML page is browsed. Use cases where this technique is helpful are, for example, lightbox styles and single page web apps where the page with the player is not initially instantiated.
---

<article class="bcls-article">
  <h1>延遲玩家實例化</h1>
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Delay_instantiation">延遲實例化</h2>
    <p>在一些用例中，您將要使用高級（頁面內嵌入）播放器實現代碼，但會延遲播放器實例化。為此，您必須更改<code translate="No">&lt;videos-js&gt;</code>標籤的屬性，並使用<code translate="No">bc()</code>初始化播放器的方法。請注意，該方法可以將玩家ID或玩家元素本身作為參數。</p>
    <aside class="bcls-aside bcls-aside--information">注意：如果您希望動態添加整個播放器，<a href="/code-samples/brightcove-player-sample-loading-player-dynamically.html"> Brightcove Player示例：動態加載播放器文檔有如何操作的說明。
  </section>
  <section id="Modify_video-js_tag" class="bcls-section">
    <h2>修改video-js標籤</h2>
    <aside class="bcls-aside bcls-aside--information player-only">注意：如果您是 Brightcove 播放器客戶，您將不會使用該<code translate="No">data-video-id</code>屬性將視頻分配給您的播放器。您可以在<strong>球員</strong>模塊，使用 curl 或<code translate="No">src</code>方法（在本文檔中使用）。
    <p>延遲播放器實例化時，您不能使用所有<code translate="No">&lt;video-js&gt;</code>標籤的屬性，否則播放器將被實例化。您必須從標準“高級"（頁內嵌入）代碼中刪除三個屬性。需要刪除的屬性有：</p>
    <ul>
      <li><code translate="No">data-account</code></li>
      <li><code translate="No">data-player</code></li>
      <li><code translate="No">data-video-id</code></li>
    </ul>
    <p>這會將以下屬性留在<code translate="No">&lt;video-js&gt;</code>標籤：</p>
    <ul>
      <li><code translate="No">data-embed</code></li>
      <li><code translate="No">class</code></li>
      <li><code translate="No">controls (optional)</code></li>
    </ul>
    <p>由於必須保留這三個屬性中的任何一個而必須刪除該屬性的原因，這將導致Brightcove Player實例化。</p>
    <p>所使用的“高級"代碼應在以下代碼片段中進行模式化。請注意<code translate="No">id</code>已添加到標籤。</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-embed="default"
  class="video-js" controls&gt;&lt;/video-js&gt;

&lt;script src="https://players.brightcove.net/1507807800001/5e28670f-28ce-4ed6-8809-227784965834_default/index.min.js"&gt;&lt;/script&gt;</code></pre>
    <p>下面顯示的對高級代碼和JavaScript代碼的這些更改共同作用，以延遲播放器的實例化。</p>
  </section>
  <section class="bcls-section">
    <h2 id="JavaScript_used">使用的JavaScript</h2>
    <p>一種非常普遍的做法是使用類似於以下代碼的代碼來準備與播放器進行編程交互：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
});</code></pre>
    <p>無法使用此方法，因為它將實例化播放器。相反，您將使用<code translate="No">bc()</code>設置其他首選項後實例化播放器的方法。這<code translate="No">bc()</code>方法用於創建Brightcove Player的新實例，通常在使用<code translate="No">&lt;video-js&gt;</code>標記，除非遵循此處詳細說明的步驟。</p>
    <div class="video-cloud-only">
      <ul>
        <li>第2-3行：為播放器聲明一個變量，並獲取<code translate="No">video-js</code>元素。</li>
        <li>第4-5行：使用JavaScript <code translate="No">setAttribute()</code>設置方法<code translate="No">data-account</code>和<code translate="No">data-player</code>。這對於跟踪分析和其他服務很重要。</li>
        <li>第6行：使用JavaScript <code translate="No">setAttribute()</code>設置視頻ID的方法。</li>
        <li>第9行：使用<code translate="No">bc()</code>初始化播放器的方法。</li>
        <li>第12-15行：以編程方式播放視頻。等待中<code translate="No">loadedmetadata</code>調度事件可確保在嘗試播放之前，目錄已檢索到該視頻。</li>
      </ul>
      <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type="text/javascript"&gt;
  var myPlayer,
    vTag = document.getElementById('myPlayerID');
  vTag.setAttribute('data-account', 1507807800001);
  vTag.setAttribute('data-player', 'BdGVdOd36');
  vTag.setAttribute('data-video-id', 2114345470001);

  // Use the bc() method to initialize the Brightcove Player
  myPlayer = <span class="bcls-highlight">bc(vTag)</span>;

  // Mute (in case there is an audio track, in which case play won't work) and play the video
  myPlayer.on('loadedmetadata',function(){
    myPlayer.muted(true);
    myPlayer.play();
  });
&lt;/script&gt;</code></pre>
    </div>
    <div class="player-only">
      <ul>
        <li>第2-3行：為播放器聲明一個變量，並獲取<code translate="No">video-js</code>元素。</li>
        <li>第4-5行：使用JavaScript <code translate="No">setAttribute()</code>設置方法<code translate="No">data-account</code>和<code translate="No">data-player</code>。這對於跟踪分析和其他服務很重要。</li>
        <li>第 8 行：使用<code translate="No">bc()</code>初始化播放器的方法。</li>
        <li>第 10 行：設置<code translate="No">src</code>為玩家。這是<strong>很重要</strong>設置兩個<code translate="No">src</code>和<code translate="No">type</code>源對象。如果播放技術順序中的第一個選項與視頻的類型不匹配，則在某些瀏覽器中可能會出現問題。</li>
        <li>第13行：以編程方式播放視頻。當然，這不是必需的。</li>
      </ul>
      <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type="text/javascript"&gt;
  var myPlayer,
    vTag = document.getElementById('myPlayerID');
  vTag.setAttribute('data-account', 1507807800001);
  vTag.setAttribute('data-player', 'BdGVdOd36');

  // Use the bc() method to initialize the Brightcove Player
  myPlayer = <span class="bcls-highlight">bc(vTag)</span>;

  myPlayer.src({ src: "//solutions.brightcove.com/bcls/assets/videos/Tiger.m3u8", type: "application/x-mpegURL"});
  // Mute (in case there is an audio track, in which case play won't work) and play the video
  myPlayer.muted(true);
  myPlayer.play();
&lt;/script&gt; </code></pre>
    </div>
    <aside class="bcls-aside bcls-aside--tip">
      <p>另外，如果您願意直接通過ID尋址元素，則可以使用以下更簡潔的代碼：</p>
      <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type="text/javascript"&gt;
  var myPlayer;
  myPlayerID.setAttribute('data-account', 1507807800001);
  myPlayerID.setAttribute('data-player', 'BdGVdOd36');
  myPlayerID.setAttribute('data-video-id', 2114345470001);

  // Use the bc() method to initialize the Brightcove Player
  myPlayer = bc('myPlayerID');

  // Mute (in case there is an audio track, in which case play won't work) and play the video
  myPlayer.on('loadedmetadata',function(){
    myPlayer.muted(true);
    myPlayer.play();
  });
&lt;/script&gt;</code></pre>
    </aside>
    <h4>不<code translate="No">id</code>在播放器上</h4>
    <p>如果由於某種原因您不希望使用<code translate="No">id</code>對於播放器，您可以使用以下代碼來延遲實例化。</p>
    <div class="video-cloud-only">
      <ul>
        <li>第3-4行：為播放器聲明一個變量，並獲取<code translate="No">video-js</code>元素。</li>
        <li>第7-8行：使用JavaScript <code translate="No">setAttribute()</code>設置方法<code translate="No">data-account</code>和<code translate="No">data-player</code>。這對於跟踪分析和其他服務很重要。</li>
        <li>第9行：使用JavaScript <code translate="No">setAttribute()</code>設置視頻ID的方法。</li>
        <li>第12行：使用<code translate="No">bc()</code>初始化播放器的方法。</li>
        <li>第15-18行：以編程方式播放視頻。等待中<code translate="No">loadedmetadata</code>調度事件可確保在嘗試播放之前，目錄已檢索到該視頻。</li>
      </ul>
      <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type="text/javascript"&gt;
  // Retrieve the element by tag name, returns an array so use the zeroth array element
  var myPlayer,
    vTag = document.getElementsByTagName('video-js')[0];

  // Assign the needed attributes
  vTag.setAttribute('data-account', 1507807800001);
  vTag.setAttribute('data-player', 'BdGVdOd36');
  vTag.setAttribute('data-video-id', 2114345470001);

  // Use the bc() method to initialize the Brightcove Player
  myPlayer = bc(vTag);

  // Mute (in case there is an audio track, in which case play won't work) and play the video
  myPlayer.on('loadedmetadata',function(){
    myPlayer.muted(true);
    myPlayer.play();
  });
&lt;/script&gt;</code></pre>
    </div>
    <div class="player-only">
      <ul>
        <li>第3-4行：為播放器聲明一個變量，並獲取<code translate="No">video-js</code>元素。</li>
        <li>第7-8行：使用JavaScript <code translate="No">setAttribute()</code>設置方法<code translate="No">data-account</code>和<code translate="No">data-player</code>。這對於跟踪分析和其他服務很重要。</li>
        <li>第11行：使用<code translate="No">bc()</code>初始化播放器的方法。</li>
        <li>第13行：設置<code translate="No">src</code>為玩家。這是<strong>很重要</strong>設置兩個<code translate="No">src</code>和<code translate="No">type</code>源對象。如果播放技術順序中的第一個選項與視頻的類型不匹配，則在某些瀏覽器中可能會出現問題。</li>
        <li>第16行：以編程方式播放視頻。當然，這不是必需的。</li>
      </ul>
      <pre class="line-numbers">
<code class="language-javascript" translate="No">&lt;script type="text/javascript"&gt;
  // Retrieve the element by tag name, returns an array so use the zeroth array element
  var myPlayer,
    vTag = document.getElementsByTagName('video-js')[0];

  // Assign the needed attributes
  vTag.setAttribute('data-account', 1507807800001);
  vTag.setAttribute('data-player', 'BdGVdOd36');

  // Use the bc() method to initialize the Brightcove Player
  myPlayer = bc('vTag');

  myPlayer.src({ src: "//solutions.brightcove.com/bcls/assets/videos/Tiger.m3u8", type: "application/x-mpegURL"});
  // Mute (in case there is an audio track, in which case play won't work) and play the video
  myPlayer.muted(true);
  myPlayer.play();
&lt;/script&gt; </code></pre>
    </div>
  </section>
  <section class="bcls-section">
    <h2 id="CSAI_with_SSAI_ad_failover">CSAI與SSAI廣告故障轉移</h2>
    <p>啟用廣告故障轉移後，Brightcove Player會檢測瀏覽器中是否存在廣告攔截器。如果沒有，則播放您的客戶端廣告（CSAI）。如果檢測到廣告攔截器，則播放器會自動請求您的服務器端廣告（SSAI）。有關詳細信息，請參見<a href="https://ssai.support.brightcove.com/vod/guides/ssai-ad-block-detection-and-auto-failover.html">SSAI：廣告攔截檢測和自動故障轉移</a>文檔。</p>
    <p>默認情況下，調用<code translate="No">bc()</code>方法強製播放器立即初始化。如果您想將廣告故障轉移與<code translate="No">bc()</code>方法，則需要等待播放器檢查是否存在廣告攔截器。您可以使用以下代碼執行此操作：</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">bc.usingAdBlocker().then(function() {
  // The promise callback receives a true/false result, which is stored
  // internally, so future bc() calls will use it. There is no need to
  // handle it yourself.
  //
  // You can pass custom arguments to bc, as normal, if needed.
  bc();
});</code></pre>
    <h3>例子</h3>
    <p>這是一些示例代碼。</p>
    <h4>的HTML</h4>
    <p>這是示例的HTML。</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
	data-embed="default"
	data-application-id
	class="video-js"
	controls
	width="640"
	height="360"&gt;&lt;/video-js&gt;
&lt;script src="//players.brightcove.net/1752604059001/W6RmT8TVL_default/index.min.js"&gt;&lt;/script&gt;</code></pre>
    <h4>JavaScript</h4>
    <p>這是該示例的JavaScript。</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">&lt;script type="text/javascript"&gt;
  // +++ Define the player options +++
  var options = {
    controlBar: {
      volumePanel: {
        inline: false,
        vertical: true
      }
    }
  };

  // +++ Add the player attributes +++
  var myPlayer,
		myPlayerEl = document.getElementById("myPlayerID");
  myPlayerEl.setAttribute('data-account', 1752604059001);
  myPlayerEl.setAttribute('data-player', 'W6RmT8TVL');
  myPlayerEl.setAttribute('data-video-id', 5802784116001);

  // +++ Create the player +++
  bc.usingAdBlocker().then(function() {
    myPlayer = bc(myPlayerEl, options);

    // +++ Optionally, mute and start playback +++
    myPlayer.on('loadedmetadata',function(){
      myPlayer.muted(true);
      myPlayer.play();
    });
  });
&lt;/script&gt;</code></pre>
  </section>
</article>