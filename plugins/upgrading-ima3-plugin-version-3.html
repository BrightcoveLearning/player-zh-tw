---
title:升級到 IMA3 插件版本 3
description: '在本主題中，您將了解如何升級到 IMA3 廣告插件版本 3。'
parent: Plugins
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
    <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Overview">概述</h2>
    <p>2018年5月，Brightcove發布了IMA廣告插件的第3版。此更新包括可靠性和其他方面的許多重大改進，本文檔下一節將對此進行詳細說明。此更新僅適用於Brightcove Player版本6和更高版本。現有的版本6播放器將不會自動遷移到版本3，因為可能需要更新某些集成以支持新版本。Brightcove鼓勵您完整閱讀本文檔，然後在升級之前測試更改。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Improvements">改進之處</h2>
    <p>以下是該插件的版本3中所做的改進的列表：</p>
    <ul>
      <li>該插件對視頻源更改的處理已從根本上進行了重新設計，與播放列表一起使用時，可提供更高的可靠性。</li>
      <li>現在可以延遲設置服務器URL，從而可以輕鬆集成異步工作流，例如標頭出價或基於媒體信息的宏。以下是兩個示例：
        <ul>
          <li>這<a href="/advertising/jump-start-header-bidding-ad.html">快速開始：標頭競價廣告</a>文檔。</li>
          <li>這<a href="/plugins/advertising-ima3-plugin.html#Implement_using_code">使用代碼實施</a> IMA3插件文檔部分。</li>
        </ul>
      </li>
      <li>已修復一個錯誤，該錯誤可能導致超時超出預期。</li>
      <li>閃存支持已刪除，以提高性能。</li>
      <li>新版本中還添加了各種其他錯誤修復和可靠性改進功能。</li>
      <li>
        <p>您可以為廣告巨集提供預設值。一個默認值可以在宏中提供，在這種情況下，將在變量未定義的地方使用此值。語法為：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">{macro=default}</code></pre>
        <p>例如，</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">http://example.com/ad/{pageVariable.adConf=1234}</code></pre>
        <p>將解析<code translate="No">window.adConf</code>為以下內容：</p>
        <pre class="line-numbers">
http://example.com/ad/1234</pre>
      </li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Technical_details">技術細節</h2>
    <p>為了提高可靠性，Brightcove IMA插件已更新了對<strong>videojs-contrib-ads</strong>，這是開源Video.js廣告框架，版本6。這是主要的維護更新。您可以了解更多有關<strong>videojs-contrib-ads</strong>版本6 <a href="http://blog.videojs.com/videojs-contrib-ads-6/"> Video.js博客</a>。</p>
    <p>此更新消除了預卷之前出現的某些內容閃爍的根本原因。解決方案使用<a href="https://blog.videojs.com/feature-spotlight-middleware/">Video.js中間件</a>無需進行快速播放並在播放開始時暫停。</p>
  </section>
  <section class="bcls-section">
    <h2 id="Migrating_to_version_3">遷移到版本3</h2>
    <p>現有的播放器不會自動升級到Brightcove IMA插件的版本3。在默認（舊版）Studio界面中，將始終像過去一樣使用IMA插件的版本2。在Beta版（新）Studio界面中，<strong>廣告</strong>部分中有一個下拉列表，可讓您選擇要使用的IMA插件版本。此新界面可用於遷移播放器。Brightcove強烈建議您檢查集成情況，並在升級時仔細測試播放器。</p>
    <p>啟用廣告後，默認情況下，新創建的播放器將使用版本3。如果需要，可以將它們手動設置為版本2。</p>
    <p>以下列出了可能需要更新集成的更改：</p>
    <ul>
      <li>您可能需要進行測試以確保您所決定的超時時間不超過配置中指定的超時時間。</li>
      <li>這<code translate="No">ended</code>事件不再延遲一秒鐘。如果您的整合回應<code translate="No">ended</code>事件，則應測試該集成是否可以按預期繼續工作。通常，這意味著此類集成將執行得更好。</li>
      <li>這<code translate="No">player.ads.state</code>現在不推薦使用該屬性。Brightcove已經看到它在某些集成中用於檢查播放器是否處於廣告模式，但通常做錯了。更好的選擇是使用<code translate="No">player.ads.isInAdMode()</code>方法。</li>
      <li>這<code translate="No">contentplayback</code>事件已被刪除。它是不再需要的實現細節，但是我們發現某些集成使用它。使用<code translate="No">playing</code>事件。</li>
      <li>廣告播放的開始由<code translate="No">ads-ad-started</code>事件，每個廣告開始時僅觸發一次。而<code translate="No">adplaying</code>事件將繼續發出，現在每次廣告播放可能會發出多次，因此Brightcove建議使用<code translate="No">ads-ad-started</code>事件。</li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Why_a_major_version_update?">為什麼要進行主要版本更新？</h2>
    <p>儘管更改可能看起來不大，但界面的幾個關鍵方面已更改，從而提示進行主要版本更新。具體來說，消除<code translate="No">contentplayback</code>事件，以及<code translate="No">timeout</code>範圍。儘管這些看起來很小，但某些集成可能取決於它們的特定行為。由於即使是很小的更改也可以對某些客戶實施產生很大的影響，因此Brightcove認為應進行較大的版本增加以表明集成應在生產中使用之前進行徹底的測試。</p>
  </section>
</article>