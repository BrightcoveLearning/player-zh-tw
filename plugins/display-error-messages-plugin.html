---
title:顯示錯誤消息插件
description: '在本主題中，您將學習如何修改默認錯誤消息行為、創建自定義錯誤消息和調度錯誤。'
parent: Plugins
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
    <summary>{{ page.description }}</summary>

    <section class="bcls-section">
        <h2 id="Overview">概述</h2>
        <p>錯誤消息插件允許播放器在遇到錯誤時顯示用戶友好的消息。默認樣式表將消息顯示為視頻元素本身頂部的半透明覆蓋層。您可以更改現有的消息文本並添加自己的樣式。您甚至可以創建需要時觸發的自定義消息。</p>
        <figure class="bcls-figure"><img class="bcls-image" alt="error message plugin" src="/assets/images/plugins/display-error-msgs/error-message-plugin.png" /></figure>
        <p>上圖中顯示的錯誤消息是通過用無效的更新播放器而創建的<code translate="No">src</code>的價值<code translate="No">sources</code>財產。</p>
        <p>錯誤消息插件是默認插件，並且會自動隨Brightcove Player一起加載。但是，您可以選擇不加載它。如果沒有此插件，您將看到一組有限的錯誤消息，並且某些錯誤將僅出現在瀏覽器控制台中。有關如何在創建播放器時不加載默認插件的詳細信息，請參見<a href="/plugins/overview-brightcove-player-plugins.html">播放器插件概述</a>文檔。</p>
        <aside class="bcls-aside bcls-aside--warning">要自定義錯誤消息，您可以使用本文檔中顯示的兩種方法之一：
            <ul>
                <li>在頁面中放置代碼：這只會更改頁面上的播放器。</li>
                <li>使用自定義插件：這將更改播放器的所有實例。</li>
            </ul>
            <strong>您不能通過更改播放器配置來自定義錯誤。</strong>
    </section>
    <section class="bcls-section">
        <h2 id="Get_started">開始吧</h2>
        <p>要更新播放器的所有實例，您可以使用Studio中的Brightcove播放器模塊來實現自定義插件。以下各節使用此方法來更新播放器的錯誤消息插件。如果您選擇從代碼頁更新此插件，它將僅影響播放器的該實例。</p>
        <p>要從您的頁面代碼更新插件，請首先獲取對Brightcove Player的引用。在此示例中，在JavaScript中，我們創建了一個名為<code translate="No">myPlayer</code>並將其分配給玩家參考。</p>
        <aside class="bcls-aside bcls-aside--information">注意：如果您使用播放器模塊通過自定義插件更新 Brightcove 播放器，則無需執行此操作。</aside>
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js <span class="bcls-highlight">id="myPlayerID"</span>
  data-video-id="4443311217001"
  data-account="1507807800001"
  data-player="default"
  data-embed="default"
  class="video-js" controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1507807800001/default_default/index.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  <span class="bcls-highlight">videojs.getPlayer('myPlayerID')</span>.ready(function(){
    var myPlayer = this;</code></pre>
    </section>
    <section class="bcls-section">
        <h2 id="standarderrors">標準錯誤</h2>
        <p>該插件具有一組基於運行時錯誤代碼值的標準HTML5視頻錯誤的默認錯誤消息：</p>
        <ul>
            <li>錯誤代碼：1
                <ul>
                    <li><strong>類型</strong>：媒體 _ 錯誤 _ 中止 </li>
                    <li><strong>標題</strong>：視頻下載已取消</li>
                    <li><strong>信息</strong>：您中止了媒體播放</li>
                </ul>
            </li>
            <li>錯誤代碼：2
                <ul>
                    <li><strong>類型</strong>：媒體 _ 錯誤 _ 網路 </li>
                    <li><strong>標題</strong>：視頻連接丟失，請確認您已連接到互聯網</li>
                    <li><strong>信息</strong>：網絡錯誤導致媒體下載部分失敗。當前對MP4和/或漸進式下載視頻格式最有幫助。見<a href="#Known_issues">已知的問題</a>有關詳細信息，請參見本文檔中的“小節"。</li>
                </ul>
            </li>
            <li>錯誤代碼：3
                <ul>
                    <li><strong>類型</strong>：媒體錯誤解碼 </li>
                    <li><strong>標題</strong>：視頻質量不佳或格式無法在您的瀏覽器上播放</li>
                    <li><strong>信息</strong>：由於損壞問題或瀏覽器不支持所使用的媒體功能，媒體播放被中止。</li>
                </ul>
            </li>
            <li>錯誤代碼：4
                <ul>
                    <li><strong>類型</strong>：媒體 _ 錯誤 _ 不支援 </li>
                    <li><strong>標題</strong>：該視頻不可用或此瀏覽器不支持</li>
                    <li><strong>信息</strong>：由於服務器或網絡出現故障或不支持該格式，因此無法加載該介質。</li>
                </ul>
            </li>
            <li>錯誤代碼：5
                <ul>
                    <li><strong>類型</strong>：媒體 _ 錯誤 _ 加密 </li>
                    <li><strong>標題</strong>：您嘗試觀看的視頻已加密，我們不知道如何解密</li>
                    <li><strong>信息</strong>：媒體已加密，我們沒有解密它的密鑰。</li>
                </ul>
            </li>
        </ul>
        <p>如果錯誤沒有相關的錯誤代碼，則會顯示一條通用消息：</p>
        <ul>
            <li>錯誤代碼：未知
                <ul>
                    <li>信息：MEDIA_ERR_UNKNOWN</li>
                    <li>描述：遇到意外問題，請稍後再試一次，然後重試</li>
                </ul>
            </li>
        </ul>
    </section>
    <section class="bcls-section">
        <h2 id="Overriding_text">覆蓋文字</h2>
        <p>您可以更改錯誤消息的三個部分：</p>
        <ul>
            <li><code translate="No">headline</code> :這是頂部的消息文本。</li>
            <li><code translate="No">type</code> :這是<strong>錯誤代碼：</strong>文本。</li>
            <li><code translate="No">message</code> :這是<strong>技術細節：</strong>文本。</li>
        </ul>
        <figure class="bcls-figure"><img class="bcls-image" alt="error message plugin" src="/assets/images/plugins/display-error-msgs/error-message-plugin2.png" /></figure>
        <!-- <p>Once your player is created, in Studio edit the <strong>Plugins</strong> section of the <strong>Players</strong> module with a JSON object to set property values.</p> -->
        <p>下面的示例顯示如何使用錯誤代碼值覆蓋標準錯誤的消息文本。<code translate="No">4</code>。這些屬性定義如下：</p>
        <ul>
            <li><code translate="No">plugins</code>：此屬性包含屬性和值的數組。對於此插件，您只需提供<code translate="No">name</code>具有以下值的屬性<code translate="No">errors</code>。</li>
            <li><code translate="No">options</code>：此屬性用於將數據傳遞到插件。</li>
            <li><code translate="No">errors</code>：此屬性定義您要更新的錯誤代碼。在這裡，我們覆蓋了消息文本<code translate="No">headline</code>，<code translate="No">type</code>， 和<code translate="No">message</code>。<aside class="bcls-aside bcls-aside--information">注意：錯誤代碼可以是任何字符串值，例如覆蓋文本<code translate="No">unknown</code>信息。</aside>
            </li>
        </ul>
        <h3>在頁面代碼中使用</h3>
        <p>如果在代碼中包含錯誤腳本，則可以覆蓋消息文本，如下所示：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">myPlayer.errors({
  "errors": {
    "4": {
      "headline": "This is a custom error message",
      "type": "custom type",
      "message": "these are details"
    }
  }
});</code></pre>
        <h3>使用自定義插件</h3>
        <p>如果要更新播放器的所有實例，請創建一個自定義插件，然後將其添加到Video Cloud Studio的“播放器"模塊中。有關插件的更多信息，請參見<a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">配置播放器插件</a>文檔。</p>
        <p>要創建一個插件來覆蓋標準消息文本，請按照下列步驟操作：</p>
        <ol class="bcls-tasklist">
            <li>
                <p>
                    使用Brightcove Player插件代碼創建一個存儲在Internet上可訪問位置的JavaScript文件。它看起來應該與此相似，但是具有您自己的值：
                </p>
                <pre class="line-numbers">
<code class="language-json" translate="No">videojs.registerPlugin('errorText', function() {
  var myPlayer = this;

  myPlayer.errors({
    &quot;errors&quot;: {
      &quot;4&quot;: {
        &quot;headline&quot;: &quot;The Live Stream will begin soon&quot;,
        &quot;type&quot;: &quot;CUSTOM_TYPE&quot;,
        &quot;message&quot;: &quot;Please come back, once the live event has begun!&quot;
      }
    }
  });
});</code></pre>
            </li>
            <li>
                <p>
                    在裡面<strong>玩家們</strong>模塊，選擇<strong>外掛程式</strong>從左側導航。
                </p>
            </li>
            <li>
                <p>
                    展開<strong>添加插件</strong>按鈕，然後選擇<strong>自定義插件</strong>。
                </p>
                <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Custom Plugin" src="/assets/images/plugins/display-error-msgs/custom-plugin.png" />
                    <figcaption class="bcls-caption--image">自定義插件</figcaption>
                </figure>
            </li>
            <li>
                <p>
                    在插件詳細信息頁面中，添加以下值：
                </p>
                <ul>
                    <li>
                        <strong>插件名稱</strong> -您的插件名稱
                    </li>
                    <li>
                        <strong>JavaScript網址</strong> -第一步中播放器插件的位置
                    </li>
                </ul>
                <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Plugin details" src="/assets/images/plugins/display-error-msgs/plugin-details.png" />
                    <figcaption class="bcls-caption--image">插件詳細信息</figcaption>
                </figure>
            </li>
            <li>
                選取「<strong>儲存</strong>」按鈕。
            </li>
            <li>
                <p>
                    發布您的播放器。
                </p>
                <aside class="bcls-aside bcls-aside--information">當您對插件代碼進行任何更改時，您需要發布播放器以使其接受這些更改。</aside>
            </li>
        </ol>

    </section>
    <section class="bcls-section">
        <h2 id="bccustomerrors">Brightcove定義的自定義錯誤</h2>
        <p>還可以定義自定義錯誤。Brightcove定義了許多自定義錯誤，在本節中進行了說明，您還可以創建自定義錯誤，在下一節中將進行詳細說明。</p>
        <ul>
            <li>Brightcove建議將自定義錯誤代碼值設置為字符串。您將看到提供的錯誤中有兩個由於歷史原因使用負數，但是字母數字/描述性字符串不太可能引起衝突問題。</li>
            <li>可以將自定義錯誤消息命名為任意名稱。Brightcove建議類型以<code translate="No">PLAYER_ERR</code>與標準化<code translate="No">MEDIA_ERR</code>避免混亂。</li>
            <li>如詳細<a href="#Making_custom_errors_non_dismissible">在本節的後面</a>，則可以將自定義錯誤設置為可忽略或不設置。</li>
        </ul>
        <p>添加了五個自定義錯誤消息作為參考：</p>
        <ul>
            <li>錯誤代碼：-1
                <ul>
                    <li>信息：PLAYER_ERR_NO_SRC</li>
                    <li>描述：尚未加載任何視頻</li>
                </ul>
            </li>
            <li>錯誤代碼：-2
                <ul>
                    <li>信息：PLAYER_ERR_TIMEOUT</li>
                    <li>描述：無法下載視頻<aside class="bcls-aside bcls-aside--information">筆記：通常，PLAYER_ERR_TIMEOUT發生在播放器希望播放視頻但<strong>45秒內無法取得任何進展</strong>。例如，這可能是許多較早發生的事情的最終結果，例如，當標籤頁置於後台時，瀏覽器將被暫停。但它可能是網絡或平台條件的一種包羅萬象的條件，阻止播放繼續。
                    </li>
                </ul>
            </li>
            <li>錯誤代碼： <em>沒有設置</em>
                <ul>
                    <li>信息：PLAYER_ERR_DOMAIN_RESTRICTED</li>
                    <li>描述：這部影片無法在您目前的網域上播放</li>
                </ul>
            </li>
            <li>錯誤代碼： <em>沒有設置</em>
                <ul>
                    <li>信息：PLAYER_ERR_IP_RESTRICTED</li>
                    <li>描述：該視頻被限制為您當前的IP地址</li>
                </ul>
            </li>
            <li>錯誤代碼： <em>沒有設置</em>
                <ul>
                    <li>信息：PLAYER_ERR_GEO_RESTRICTED</li>
                    <li>描述：該視頻禁止在您當前的地理區域播放</li>
                </ul>
            </li>
        </ul>
        <aside class="bcls-aside bcls-aside--information">對於那些沒有代碼的錯誤，消息將用於代碼。例如，此處顯示域限制錯誤：
            <figure class="bcls-figure"><img class="bcls-image" alt="domain restriction error message" src="/assets/images/plugins/display-error-msgs/domain-restriction-error.png" /></figure>
        </aside>
    </section>
    <section class="bcls-section">
        <h2 id="usercustomerrors">用戶定義的自定義錯誤</h2>
        <p>在定義您自己的自定義錯誤時，Brightcove建議您不要使用<strong>代碼</strong>。（您在上面的部分中看到，這就是Brightcove現在正在處理的，它們正在定義較新的自定義錯誤。）您還應該考慮使用<code translate="No">PLAYER_ERR_</code>為了保持一致性，您可以為自定義錯誤添加前綴，但是當然可以根據需要命名它們。</p>
        <!-- <p>This example creates a new user defined custom error message with an error code value of <code translate="No">PLAYER_ERR_AGE_GATE</code> and includes text based on an age gate test that you would enter in Studio's <strong>PLAYERS &gt; PLUGINS</strong> section.</p>
    <pre class="line-numbers">
<code class="language-json" translate="No">{
  "errors": {
    "PLAYER_ERR_AGE_GATE": {
      "headline": "You must be at least 18 years of age.",
      "message": "Content may be considered inappropriate for some users."
    }
  }
}</code></pre> -->
        <p>如果在代碼中包含錯誤腳本，則可以按以下方式添加自定義消息：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.getPlayer('myPlayerID').ready(function() {
  var myPlayer = this;
  //custom error
  myPlayer.errors({
    "errors": {
      "PLAYER_ERR_AGE_GATE": {
        "headline": "You must be at least 18 years of age.",
        "message": "Content may be considered inappropriate for some users."
    }
  }
});</code></pre>
        <h3>顯示自定義錯誤</h3>
        <p>定義自定義錯誤時，需要在需要顯示時讓Brightcove Player知道。為此，請創建您自己的代碼以確定何時顯示該消息。然後使用<code translate="No">error()</code>顯示消息的功能如下：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">//display custom message
var age_appropriate = false;
myPlayer.on("loadstart", function () {
  if(!age_appropriate) {
    myPlayer.error({code:'PLAYER_ERR_AGE_GATE'});
  }
});</code></pre>
        <p>在這裡<code translate="No">age_appropriate</code>變量設置為<code translate="No">false</code>，但是您將添加自己的代碼來確定何時顯示自定義錯誤消息。</p>
        <p>該錯誤將顯示給用戶，如下所示：</p>
        <figure class="bcls-figure"><img class="bcls-image" alt="user custom error message" src="/assets/images/plugins/display-error-msgs/user-custom-error-message.png" /></figure>
        <aside class="bcls-aside bcls-aside--tip">注意：任何拋出自定義錯誤的代碼都必須等待視頻加載。使用<code translate="No">loadstart</code>事件來確定這一點。如果您嘗試不等待就顯示您的消息，那麼您的消息將在視頻加載後消失。
    </section>
    <section class="bcls-section">
        <h2 id="Making_custom_errors_non_dismissible">使自定義錯誤不可忽略</h2>
        <p>默認情況下，視頻查看器會拒絕自定義錯誤消息。如以下屏幕截圖所示，有一個<strong>好的</strong>按鈕以關閉窗口，以及<strong>X</strong>在右上角。</p>
        <figure class="bcls-figure"><img class="bcls-image" alt="dismissible error message" src="/assets/images/plugins/display-error-msgs/dismissible.png" /></figure>
        <p>如果您不想允許視頻查看器消除該錯誤消息，則可以執行此操作。當您致電<code translate="No">error()</code>方法，您可以設置<code translate="No">dismiss</code>財產給<code translate="No">false</code>。</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">myPlayer.error({code:'age-gate-error', <span class="bcls-highlight">dismiss: false</span>});</code></pre>
        <p>執行此操作時，錯誤消息將顯示如下，而無法消除該錯誤。</p>
        <figure class="bcls-figure"><img class="bcls-image" alt="not dismissible error message" src="/assets/images/plugins/display-error-msgs/not-dismissible.png" /></figure>
    </section>
    <section class="bcls-section">
        <h2 id="getAll_method">getAll（）方法</h2>
        <p>您可以使用<code translate="No">getAll()</code>查看針對特定播放器註冊的所有錯誤的方法。您可以致電<code translate="No">getAll()</code>之後的任何時間<strong>錯誤</strong>插件已初始化，例如之後<code translate="No">player.errors()</code>已被調用。調用該方法的一個示例是：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">console.log('myPlayer.errors.getAll()',myPlayer.errors.getAll());</code></pre>
        <p>控制台顯示的示例，其中擴展了一些錯誤以獲取詳細信息：</p>
        <figure class="bcls-figure"><img class="bcls-image" alt="getAll console display" src="/assets/images/plugins/display-error-msgs/getAll-method.png" /></figure>
    </section>
    <section id="dispatcherror" class="bcls-section">
        <h2>派送錯誤</h2>
        <p>在開發中，您可能希望分派錯誤以測試配置更改是否成功。您可以使用類似於以下代碼段所示的代碼來執行此操作。在這種情況下，將在代碼中添加一個按鈕，以便您可以在選定的時間分派錯誤。</p>
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="4443311217001"
  data-account="1507807800001"
  data-player="default"
  data-embed="default"
  class="video-js" controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1507807800001/default_default/index.min.js"&gt;&lt;/script&gt;
&lt;p&gt;&lt;button onclick="changeVideo()"&gt;change video&lt;/button&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;
  var changeVideo;
  videojs.getPlayer('myPlayerID').ready(function() {
    var myPlayer = this;
    changeVideo = function(){
      myPlayer.error({code:'2'});
    }
  });
&lt;/script&gt;</code></pre>
    </section>
    <section class="bcls-section">
        <h2 id="Localize_errors">本地化錯誤</h2>
        <p>錯誤插件支持多種語言。要增加語言支持，請在插件加載後加載您要使用的特定語言文件：</p>
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script src="lang/es.js"&gt;&lt;/script&gt;</code></pre>
        <p>然後，您可以使用<a href="/coding-topics/programmatically-localizing-brightcove-player.html">以編程方式本地化Brightcove Player</a>文檔以定位錯誤消息。</p>
    </section>
    <section class="bcls-section">
        <h2 id="bc-catalog-error">bc目錄錯誤</h2>
        <p>正常情況下可能會處理錯誤<code translate="No">ready()</code>腳本塊中的“節"可能會導致問題。例如，可能發生了bc-catalog-error事件可能在播放器準備就緒之前分派，並且如果您在播放器中偵聽該錯誤，<code translate="No">ready()</code>部分，您將無法處理該錯誤。使用地理過濾，視頻處於非活動狀態，視頻超出計劃範圍或使用其他帳戶時，可能會發生此問題。您可能會發現代碼中沒有問題，但是該問題可能取決於瀏覽器，因此請謹慎使用。</p>
        <p>例如，以下是在視頻處於非活動狀態時顯示消息的插件代碼：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.registerPlugin('inactiveErrorCheck', function() {
  var myPlayer = this;
  myPlayer.one('bc-catalog-error', function(){
    var specificError;
    myPlayer.errors({
      'errors': {
          'inactive-video-error': {
          'headline': 'The video you are trying to watch is inactive.',
          'dismiss': false
        }
      }
    });
    if (typeof(myPlayer.catalog.error) !== 'undefined') {
      specificError = myPlayer.catalog.error.data[0];
      if (specificError !== 'undefined' &amp; specificError.error_code == "VIDEO_NOT_PLAYABLE") {
        myPlayer.error({code:'inactive-video-error'});
      };
    };
  });
});</code></pre>
        <aside class="bcls-aside bcls-aside--tip">有關處理目錄錯誤的完整詳細信息，請參閱<a href="/references/player-catalog.html#catalog-error">處理 bc-catalog-error</a>的部分<strong>球員目錄</strong>文檔。</aside>
    </section>
    <section class="bcls-section">
        <h2 id="Exaggerated_error_rate">誇大的錯誤率</h2>
        <p>如果您發現報告的錯誤數量似乎不合理，那麼重要的是要知道您可以在同一會話中獲得重複的錯誤事件，從而造成這種誇大的錯誤率。Brightcove Player會將錯誤報告給播放器，並在準確的時間和相同的數量下將其發送到分析。例如，如果播放器中沒有媒體，並且以某種方式編碼調用<code translate="No">play()</code>連續一千次<strong>PLAYER_ERR_NO_SRC</strong>錯誤將報告給分析。</p>
        <p>如果有幾個會話因大量錯誤而使分析歪斜，則應考慮使用以下邏輯來更好地了解實際問題：</p>
        <pre class="line-numbers">
<code class="language-javascript" translate="No">number_of_sessions_with_errors / total_number_of_sessions</code></pre>
        而不是
        <pre class="line-numbers">
<code class="language-javascript" translate="No">count of errors/number of views</code></pre>
    </section>
    <section class="bcls-section">
        <h2 id="Known_issues">已知的問題</h2>
        <ul>
            <li>播放HLS源時，失去網絡連接後的行為可能不是您期望的。詳細信息是：
                <ul>
                    <li>在Brightcove Player版本6.x中，無休止地請求HLS段，並且沒有<strong>MEDIA_ERR_NETWORK</strong>曾經出現。</li>
                    <li>一段時間（30秒鐘以上）後，在Brightcove Player的5.x版本中a <strong> PLAYER_ERR_TIMEOUT</strong>錯誤出現。</li>
                </ul>
            </li>
            <li>在Windows 10上的Edge中（在Studio中和公共URL中）加載視頻時，<strong> MEDIA_ERR_SRC_NOT_SUPPORTED</strong>顯示錯誤，並且無法播放視頻。</li>
            <li>
                <p>在Android設備和iPhone上，錯誤消息的點擊事件不會冒泡到父視頻元素。這意味著一旦出現錯誤消息，您將無法關閉。如果用戶處於全屏模式，則此行為可能是個問題，因為他們將無法退出此狀態。</p>
                <p>這個問題目前正在處理中，應該在以後的播放器版本中修復。目前，您可以嘗試採用以下解決方法：</p>
                <pre class="line-numbers">
<code class="language-javascript" translate="No">player.on("touchstart", function(e) {
  if (player.error_) {
    player.error(null);
    e.preventDefault();
  }
})</code></pre>
            </li>
        </ul>
    </section>
    <section class="bcls-section">
        <h2 id="changelog">變更記錄檔</h2>
        <p>見<a href="/plugins/changelog/display-error-messages-plugin-changelog.html">這裡的變更日誌</a>。</p>
    </section>
</article>