---
title:質量選擇插件
description:"In this topic, you will learn how to use the Quality Selection Plugin.該插件在播放器的控制欄中提供了一個菜單按鈕，允許您手動選擇 HLS 或 Dash 源的播放質量。”
parent: Plugins
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
    <summary>{{ page.description }}</summary>

    <br/>
  <aside class="bcls-aside bcls-aside--information">
    <p>注意：“質量選擇插件"不適用於所有視頻源。以下幾點說明了這種情況：</p>
    <ul>
      <li>該插件僅適用於HLS / DASH源。</li>
      <li>該插件將顯示任何M3U8主文件的分辨率信息，其中包括子副本的分辨率信息。如果未指定分辨率，則插件將顯示HD / SD。</li>
      <li>無論在何處託管HLS M3U8文件，無論它是LIVE還是VOD。</li>
      <li>該插件不適用於MP4。如果您有五個MP4信號源，而只有一個HLS信號源，您將看不到顯示不同MP4質量的質量選擇器。</li>
    </ul>
  </aside>
  <section class="bcls-section">
    <h2 id="Player_example">播放器示例</h2>
    <p>以下是使用質量選擇插件的Brightcove Player。播放視頻後，您將在控制欄中看到以下圖標： <img alt="" src="/assets/images/plugins/quality-selection/icon-in-controlbar.png" /></p>
    <p>選擇之後，齒輪將旋轉，直到對於DASH源顯示新的質量，或者對於HLS源顯示新的質量。下面提供了有關您選擇的質量選項以及齒輪旋轉行為的更多信息。</p>
    <aside class="bcls-aside bcls-aside--information">如果您的 Internet 連接速度很快，您可能需要進行多項選擇，然後才能看到齒輪旋轉，因為此視頻使用的 HLS 再現會快速發生變化。</aside>
    <video data-video-id="5842800655001" data-account="1752604059001" data-player="B1CWQFiPZ" data-embed="default" data-application-id="" class="video-js" controls="" width="640" height="360">&nbsp;</video>
    <script src="//players.brightcove.net/1752604059001/B1CWQFiPZ_default/index.min.js"></script>
    </section>
    <section class="bcls-section">
      <h2 id="Quality_options">質量選擇</h2>
      <p>單擊齒輪圖標時，將顯示許多質量選項供用戶選擇。例如，具有以下呈現形式的視頻：</p>
      <figure class="bcls-figure"><img class="bcls-image" alt="All video renditions" src="/assets/images/plugins/quality-selection/video-renditions.png" /></figure>
      <p>將創建以下質量選項：</p>
      <figure class="bcls-figure"><img class="bcls-image" alt="Quality options" src="/assets/images/plugins/quality-selection/quality-options.png" /></figure>
      <p>這是構建這些選項然後選擇特定格式的方式：</p>
      <ul>
        <li>基於水平分辨率的線（例如，在上面的示例中為270p，360p，540p，720p和1080p）將所有演繹分組，並用作質量選項。</li>
        <li>在用戶選擇了一個組之後，如果所選組中存在多個再現，則標準自適應比特率流算法將在所選分辨率組中選擇最佳再現。該過程是移交選擇當前如何工作的過程，但僅限於選定的分辨率組內。</li>
        <li>如果沒有分辨率信息，則選項將回退以顯示選項<strong>標清</strong>和<strong>高清</strong>，分別用於標清和高清。該插件將使用可配置的分隔線，為每個再現使用比特率信息來確定它是SD還是HD。</li>
      </ul>
    </section>
    <section class="bcls-section">
      <h2 id="Buffering">正在緩衝</h2>
      <p>更改質量時，可能會發生一些緩衝，您會看到加載微調框。這是因為質量會在選擇質量時立即更改，並且需要下載細分。如果您希望具有與自動移交開關相同的平滑過渡行為，則可以使用以下選項手動初始化播放器：</p>
      <pre class="line-numbers">
<code class="language-javascript" translate="No">var options = {
  html5: {
    hls: {
      smoothQualityChange: true
    }
  }
};</code></pre>
      <p>有關使用手動初始化播放器的詳細信息<code translate="No">bc()</code>方法可以在<a href="/coding-topics/using-bc-and-getplayer-methods.html#bc_method_details">使用bc（）和getPlayer（）方法</a>文檔。</p>
    </section>
    <section class="bcls-section">
      <h2 id="Gear_spinning">齒輪旋轉</h2>
      <p>齒輪圖標旋轉表示更改了所使用的演繹形式。對於DASH和HLS源，旋轉的規則有所不同：</p>
      <ul>
        <li>對於DASH源，齒輪將旋轉，直到播放器中的質量發生變化並在屏幕上呈現為止。</li>
        <li>對於HLS源，當內部算法決定開始加載新質量時，而不是在渲染新質量時，齒輪停止旋轉。該決定很快發生，因此很可能您看不到HLS源頻繁發生的旋轉操作。</li>
      </ul>
    </section>
    <section class="bcls-section">
      <h2 id="Implement_using_Players_module">使用播放器模組實作</h2>
      <p>要使用Players模塊實現質量選擇插件，請按照以下步驟操作：</p>
      <ol class="bcls-tasklist">
        <li>打開<strong>球員</strong>模塊並創建一個新播放器或找到您希望添加插件的播放器。</li>
        <li>單擊播放器的鏈接以打開播放器的屬性。</li>
        <li>點擊<strong>控制項</strong>在左側導航菜單中。</li>
        <li>選中前面的框<strong>質量選擇器</strong>。
          <figure class="bcls-figure"><img class="bcls-image" alt="Configuration show quality selector" src="/assets/images/plugins/quality-selection/studio-show-quality-selector.png" /></figure>
        </li>
        <li>使用單選按鈕可以顯示可用的不同分辨率，也可以僅顯示一個<strong>高清/標清</strong>選項。</li>
        <li>點擊<strong>保存</strong>。</li>
        <li>若要發佈播放程式，請按一下「<strong>發佈與內嵌」&gt;「發佈變更」</strong>。</li>
        <li>若要關閉開啟對話方塊，請按一下「<strong>關閉」</strong>。</li>
      </ol>
    </section>
    <section class="bcls-section">
      <h2 id="Implement_using_Code">使用代碼實施</h2>
      <p>要使用代碼實現質量選擇插件，請按照以下步驟操作：</p>
      <ol class="bcls-tasklist-restart">
        <li>
          <p>
            在編輯器中，打開您想要Brightcove Player駐留的HTML代碼。
          </p>
        </li>
        <li>
          <p>
            在裡面<code translate="No">head</code>部分，添加質量選擇插件默認樣式表。
          </p>
          <pre>
<code class="language-html" translate="No">&lt;link href=&quot;https://players.brightcove.net/videojs-quality-menu/1/videojs-quality-menu.css&quot; rel='stylesheet'&gt;</code></pre>
        </li>
        <li>
          <p>
            在裡面<code translate="No">body</code>部分，添加高級播放器嵌入代碼。
          </p>
          <aside class="bcls-aside bcls-aside--tip">對於播放器嵌入代碼，我們添加了一個<code translate="No">id</code>屬性，以便我們可以在以後的腳本中獲得對播放器的引用。</aside>
          <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js <span class="bcls-highlight">id=&quot;myPlayerID&quot;</span>
  data-account=&quot;1752604059001&quot;
  data-player=&quot;default&quot;
  data-embed=&quot;default&quot;
  controls=&quot;&quot;
  data-video-id=&quot;5842800655001&quot;
  data-playlist-id=&quot;&quot;
  data-application-id=&quot;&quot;
  width=&quot;960&quot; height=&quot;540&quot;&gt;&lt;/video-js&gt;
&lt;script src=&quot;https://players.brightcove.net/1752604059001/default_default/index.min.js&quot;&gt;&lt;/script&gt;</code></pre>
        </li>
        <li>
          <p>
            播放器嵌入代碼後，添加質量選擇插件腳本文件。
          </p>
          <pre>
<code class="language-html" translate="No">&lt;script src=&quot;https://players.brightcove.net/videojs-quality-menu/1/videojs-quality-menu.min.js&quot;&gt;&lt;/script&gt;</code></pre>
        </li>
        <li>
          <p>
            在插件腳本下面，添加一個執行以下操作的腳本：
          </p>
          <ul>
            <li>
              獲取對Brightcove Player的參考。
            </li>
            <li>
              向播放器註冊質量選擇插件。
            </li>
            <li>
              指定您要使用的任何插件選項。在此示例中，我們將默認質量選擇設置為<code translate="No">720p</code>。
            </li>
          </ul>
          <pre class="line-numbers">
<code class="language-html" translate="No">&lt;script type=&quot;text/javascript&quot;&gt;
  videojs.getPlayer('myPlayerID').ready(function() {
    var myPlayer = this;
    myPlayer.qualityMenu({
      defaultResolution: '720p'
    });
  });
&lt;/script&gt;</code></pre>
        </li>
      </ol>
      <details>
        <summary>
          <h2 id="Complete_code_example">完整的代碼示例</h2>
        </summary>
        <p>這是使用質量選擇插件，設置初始默認分辨率的完整代碼示例：</p>
        <pre class="line-numbers">
<code class="language-html" translate="No">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
      &lt;title&gt;Quality Selection&lt;/title&gt;

      &lt;!-- CSS for the quality selection plugin --&gt;
      &lt;link href=&quot;https://players.brightcove.net/videojs-quality-menu/1/videojs-quality-menu.css&quot; rel='stylesheet'&gt;
    &lt;/head&gt;

    &lt;body&gt;
    &lt;h1&gt;Quality Selection&lt;/h1&gt;

    &lt;!-- Brightcove Player embed code --&gt;
    &lt;video-js id=&quot;myPlayerID&quot;
      data-account=&quot;1752604059001&quot;
      data-player=&quot;default&quot;
      data-embed=&quot;default&quot;
      controls=&quot;&quot;
      data-video-id=&quot;5842800655001&quot;
      data-playlist-id=&quot;&quot;
      data-application-id=&quot;&quot;
      width=&quot;960&quot; height=&quot;540&quot;&gt;&lt;/video-js&gt;
    &lt;script src=&quot;https://players.brightcove.net/1752604059001/default_default/index.min.js&quot;&gt;&lt;/script&gt;

    &lt;!-- Script for the quality selection plugin --&gt;
    &lt;script src=&quot;https://players.brightcove.net/videojs-quality-menu/1/videojs-quality-menu.min.js&quot;&gt;&lt;/script&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
      // When the player is ready, get a reference to it
      videojs.getPlayer('myPlayerID').ready(function() {
        var myPlayer = this;

        // Register the quality selection plugin with options
        myPlayer.qualityMenu({
          defaultResolution: '720p'
        });
      });
    &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
      </details>
    </section>
    <section class="bcls-section">
      <h2 id="Configuration_options">配置選項</h2>
      <p>如果您使用代碼實現插件，則可以使用以下選項來配置插件：</p>
      <ul>
        <li>
          <h3><code translate="No">defaultResolution</code></h3>
          <ul>
            <li>類型：<code translate="No">String</code>   </li>
            <li>默認：<code translate="No">none</code></li>
            <li>定義要使用的默認分辨率或分辨率映射。通過水平分辨率或<strong>標清</strong> / <strong>高清</strong>。</li>
          </ul>
          <h4>更改Video Cloud Studio中的默認初始分辨率</h4>
          <p>請按照以下步驟更改Video Cloud Studio中的默認分辨率：</p>
          <ol class="bcls-tasklist-restart">
            <li>在裡面<strong>選手們</strong>模塊，選擇已向其添加了Quality Selection插件的播放器。</li>
            <li>在左側導航中，選擇<strong>JSON編輯器</strong>。</li>
            <li>在“質量選擇插件"中找到有關“質量選擇插件"的部分。<code>外掛程式</code>部分，如下所示：
              <pre class="line-numbers"><code class="language-json" translate="No">{
    "registry_id": "@brightcove/videojs-quality-menu",
    "version": "1.x",
    "options": {
      "useResolutionLabels": true
    }
  }</code></pre>
            </li>
            <li>到<code>選項</code>部分中，添加所需的默認分辨率，如突出顯示的部分所示（不要忘記在上一行的末尾添加逗號）：
              <pre class="line-numbers"><code class="language-json" translate="No">{
    "registry_id": "@brightcove/videojs-quality-menu",
    "version": "1.x",
    "options": {
      "useResolutionLabels": true,
      <span class="bcls-highlight">"defaultResolution": "720p"</span>
    }
  }</code></pre>
            </li>
            <li>點擊<strong>保存</strong>保存更改後的JSON。</li>
            <li>發布更改的播放器。</li>
          </ol>
          <aside class="bcls-aside bcls-aside--tip">當然，類似的步驟可用於使用 Video Cloud Studio 設置本節中的任何選項。</aside>
        </li>
        <li>
          <h3><code translate="No">sdBitrateLimit</code></h3>
          <ul>
            <li>類型：<code translate="No">Number</code>   </li>
            <li>默認：<code translate="No">2000000</code></li>
            <li>定義用於考慮演繹的最高比特率限制（不包括）<strong>標清</strong>。</li>
          </ul>
        </li>
        <li>
          <h3><code translate="No">useResolutionLabels</code></h3>
          <ul>
            <li>類型：<code translate="No">Boolean</code></li>
            <li>默認：<code translate="No">true</code></li>
            <li>什麼時候<code translate="No">true</code>，則該插件將嘗試按水平分辨率的行對演繹進行分類。設置為false以始終使用<strong>標清</strong> / <strong>高清</strong>分類。</li>
          </ul>
          <p>實施<code translate="No">useResolutionLabels</code>選項，您將在Studio的插件選項中輸入以下內容：</p>
          <pre class="line-numbers">
<code class="language-json" translate="No">{
  "useResolutionLabels": false
}</code></pre>
          <p>產生的質量選項將顯示如下：</p>
          <figure class="bcls-figure"><img class="bcls-image" alt="Options SD and HD only" src="/assets/images/plugins/quality-selection/quality-options-sd-hd-only.png" /></figure>
          <p>然後，玩家將從所選組中選擇最佳演繹形式。如本節中所述，<code translate="No">sdBitrateLimit</code>可配置以確定歸類為<strong>標清</strong>和<strong>高清。</strong></p>
          <aside class="bcls-aside bcls-aside--tip">矛盾的設置將不起作用。例如，以下兩種情況都沒有用處，因為在兩種情況下，您都基於<code translate="No">useResolutionLabels</code>環境。
            <pre class="line-numbers">
<code class="language-json" translate="No">"useResolutionLabels": true,
"defaultResolution": "HD"</code></pre>
            <pre class="line-numbers">
<code class="language-json" translate="No">"useResolutionLabels": false,
"defaultResolution": "1080p"</code></pre>
          </aside>
        </li>
        <li>
          <h3><code translate="No">resolutionLabelBitrates</code></h3>
          <ul>
            <li>類型：<code translate="No">Boolean</code>   </li>
            <li>默認：<code translate="No">false</code></li>
            <li>什麼時候<code translate="No">true</code>，該插件會將比特率信息附加到分辨率標籤（例如720p @ 13806 kbps）。該選項在以下情況下無效<code translate="No">useResolutionLabels</code>為false或解決方案信息不可用時。</li>
          </ul>
          <p>設置此配置選項後，<code translate="No">true</code>，質量選擇器將顯示如下：</p>
          <figure class="bcls-figure"><img class="bcls-image" alt="All video bitrates" src="/assets/images/plugins/quality-selection/bitrates-displayed.png" /></figure>
        </li>
      </ul>
    </section>

    <section class="bcls-section">
      <h2 id="Styling_the_control">設置控件樣式</h2>
      <p>CSS用於設置齒輪圖標以及顯示的菜單的樣式。下表顯示了您可以設置樣式的常用組件，組件選擇器，最後是要設置的 CSS 屬性。</p>
      <table class="bcls-table">
        <thead class="bcls-table__head">
          <tr>
            <th>元件  </th>
            <th>選擇器</th>
            <th>財產</th>
          </tr>
        </thead>
        <tbody class="bcls-table__body">
          <tr>
            <td>齒輪圖標</td>
            <td>button.vjs-質量菜單-button.vjs-菜單-button.vjs-menu-button-popup.vjs-button</td>
            <td>顏色</td>
          </tr>
          <tr>
            <td>菜單項的顏色</td>
            <td>div.vjs-質量-菜單-包裝器.vjs-菜單-按鈕.vjs-菜單-按鈕-彈出式.vjs-control.vjs-按鈕.vjs-質量-菜單-按鈕使用分辨率.vjs-菜單-項目</td>
            <td>背景顏色</td>
          </tr>
          <tr>
            <td>菜單項的文字顏色</td>
            <td>div.vjs-質量-菜單-包裝器.vjs-菜單-按鈕.vjs-菜單-按鈕-彈出式.vjs-control.vjs-按鈕.vjs-質量-菜單-按鈕使用分辨率.vjs-菜單-項目-文本</td>
            <td>顏色</td>
          </tr>
          <tr>
            <td>所選菜單項的顏色</td>
            <td>div.vjs-質量-菜單-包裝器.vjs-菜單-按鈕.vjs-菜單-按鈕-彈出式.vjs-control.vjs-按鈕.vjs-質量-菜單-按鈕使用分辨率.vjs-菜單-項目。 vjs-selected</td>
            <td>背景顏色</td>
          </tr>
          <tr>
            <td>所選項目的文字顏色</td>
            <td>div.vjs-質量-菜單-包裝器.vjs-菜單-按鈕.vjs-菜單-按鈕-彈出式.vjs-control.vjs-按鈕.vjs-質量-菜單-按鈕使用分辨率.vjs-菜單-項目。 vjs選擇的.vjs菜單項文本</td>
            <td>顏色</td>
          </tr>
          <tr>
            <td>文字顏色<strong>高清</strong>標籤</td>
            <td>div.vjs-質量-菜單-包裝器.vjs-菜單-按鈕.vjs-菜單-按鈕-彈出式.vjs-control.vjs-按鈕.vjs-質量-菜單-按鈕使用分辨率.vjs-質量-菜單-項目子標籤</td>
            <td>顏色</td>
          </tr>
        </tbody>
      </table>
      <p>例如，要實現以下目的：</p>
      <figure class="bcls-figure"><img class="bcls-image" alt="All video bitrates" src="/assets/images/plugins/quality-selection/styled-menu.png" /></figure>
      <p>您將使用以下CSS：</p>
      <pre class="line-numbers">
<code class="language-css" translate="No">/* Style the icon */
button.vjs-quality-menu-button.vjs-menu-button.vjs-menu-button-popup.vjs-button {
  color: red;
}
/* Style the background of the menu items */
div.vjs-quality-menu-wrapper.vjs-menu-button.vjs-menu-button-popup.vjs-control.vjs-button.vjs-quality-menu-button-use-resolution .vjs-menu-item {
  background-color: yellow;
}
/* Style the text of menu items */
div.vjs-quality-menu-wrapper.vjs-menu-button.vjs-menu-button-popup.vjs-control.vjs-button.vjs-quality-menu-button-use-resolution .vjs-menu-item-text {
  color: green;
}
/* Style the background color of selected menu item */
div.vjs-quality-menu-wrapper.vjs-menu-button.vjs-menu-button-popup.vjs-control.vjs-button.vjs-quality-menu-button-use-resolution .vjs-menu-item.vjs-selected {
  background-color: white;
}
/* Style the text color of selected menu item */
div.vjs-quality-menu-wrapper.vjs-menu-button.vjs-menu-button-popup.vjs-control.vjs-button.vjs-quality-menu-button-use-resolution .vjs-menu-item.vjs-selected .vjs-menu-item-text{
  color: blue;
}
/* Style the HD label */
div.vjs-quality-menu-wrapper.vjs-menu-button.vjs-menu-button-popup.vjs-control.vjs-button.vjs-quality-menu-button-use-resolution .vjs-quality-menu-item-sub-label {
  color: lime;
}</code></pre>
    </section>
    <section class="bcls-section">
      <h2 id="Known_issues">已知的問題</h2>
      <ul>
        <li>該插件可與Brightcove Player 5.17.0及更高版本一起使用。不支持播放器早期版本的功能。</li>
        <li>質量選擇器在Safari中不起作用。</li>
        <li>質量選擇器不會出現在iOS中。</li>
        <li>有時質量切換不會在期望的時間發生，它可能花費比預期更長的時間。</li>
        <li>在播放器配置中設置源並使用單個視頻模板進行構建會導致質量菜單無法正確初始化。這是因為將通過調用<code translate="No">videojs</code>構造函數，它無權訪問播放器或插件。源應通過調用來設置<code translate="No">player.src()</code>。這不會影響視頻雲用戶。</li>
        <li>在Silverlight中使用DASH內容時，將不會顯示質量菜單。</li>
        <li>選擇器中的視頻質量被重設為<strong>汽車</strong>在每個玩家負載下。它不會保留任何先前的設置。</li>
      </ul>
    </section>
    <section class="bcls-section">
      <h2 id="Changelog">變更記錄檔</h2>
      <p>見<a href="http://players.brightcove.net/release-notes/brightcove-player-quality-menu/index.html">質量菜單插件發行說明</a> .</p>
      <p>有關歷史發行說明，請參閱<a href="/plugins/changelog/quality-selection-plugin-changelog.html">更新日誌在這裡</a> .</p>
    </section>
  </section>
</article>